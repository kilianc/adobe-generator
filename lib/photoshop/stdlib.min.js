function getUnitValue(e){return e.value!=undefined?e.value:e}function newLocalString(e,t,n,r,i){(!e||!e.beginsWith("$$$/"))&&Error.runtimeError(19,"scope"),t||Error.runtimeError(19,"name"),r==undefined&&(r="str"),n==undefined&&(n=t),e.endsWith("/")||(e+="/");var s=localize(e+t+"="+n);return i&&(i[r+t]=s),s}function throwFileError(e,t){t==undefined&&(t=""),Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(e,t))}function _weekNumber(e){var t=toNumber(e.strftime("%j")),n=Math.floor(t/7);return(new Date(e.getFullYear(),0,1)).getDay()<4&&n++,n}function toBoolean(e){if(e==undefined)return!1;if(e.constructor==Boolean)return e.valueOf();try{e instanceof XML&&(e=e.toString())}catch(t){}return e.constructor==String?e.toLowerCase()=="true":Boolean(e)}function isBoolean(e){return e!=undefined&&e.constructor==Boolean}function toNumber(e,t){if(e==undefined)return t||NaN;try{e instanceof XML&&(e=e.toString())}catch(n){}if(e.constructor==String&&e.length==0)return t||NaN;if(e.constructor==Number)return e.valueOf();var r=Number(e.toString());return isNaN(r)?t||NaN:r}function isNumber(e){try{e instanceof XML&&(e=e.toString())}catch(t){}return!isNaN(e)}function isString(e){return e!=undefined&&e.constructor==String}function toFont(e){if(e.typename=="TextFont")return e.postScriptName;var t=e.toString(),n=Stdlib.determineFont(t);return n?n.postScriptName:undefined}cTID=function(e){return cTID[e]||cTID[e]=app.charIDToTypeID(e)},sTID=function(e){return sTID[e]||sTID[e]=app.stringIDToTypeID(e)},xTID=function(e){if(e==undefined)if(!isCS()&&!isCS2())try{Stdlib.log("undefined id detected at: "+$.stack)}catch(t){Stdlib.log("undefined id detected")}else Stdlib.log("undefined id detected");if(e.constructor==Number)return e;try{if(e instanceof XML){var n=e.nodeKind();if(n=="text"||n=="attribute")e=e.toString()}}catch(t){}if(e.constructor==String&&e.length>0){if(e.length!=4)return sTID(e);try{return cTID(e)}catch(t){return sTID(e)}}return Error.runtimeError(19,e),undefined},id2char=function(e,t){if(isNaN(Number(e)))return"";var n,r=$.level;$.level=0;try{if(!n)try{n=PSConstants.reverseNameLookup(e,t)}catch(i){}if(!n)try{n=PSConstants.reverseSymLookup(e)}catch(i){}if(!n)try{n=app.typeIDToCharID(e)}catch(i){}if(!n)try{n=app.typeIDToStringID(e)}catch(i){}}catch(i){}return $.level=r,n||(n=Stdlib.numberToAscii(e)),n?n:e},id2charId=function(e,t){if(isNaN(Number(e)))return"";var n,r=$.level;$.level=0;try{if(!n)try{n=PSConstants.reverseSymLookup(e)}catch(i){}if(!n)try{n=app.typeIDToCharID(e)}catch(i){}if(!n)try{n=PSConstants.reverseNameLookup(e,t)}catch(i){}if(!n)try{n=app.typeIDToStringID(e)}catch(i){}}catch(i){}return $.level=r,n||(n=Stdlib.numberToAscii(e)),n?n:e},id2name=function(e){return id2char(e)},$.evalFile?global=$.global:global=this,isPhotoshop=function(){return!!app.name.match(/photoshop/i)},isPhotoshopElements=function(){return!!BridgeTalk.appName.match(/pseeditor/i)},isPSE=isPhotoshopElements,isBridge=function(){return!!app.name.match(/bridge/i)},isInDesign=function(){return!!app.name.match(/indesign/i)};var psVersion,pseVersion;try{var lvl=$.level;psVersion=app.version;if(isPSE()){pseVersion=psVersion;var _tmp=psVersion.split(/\./);_tmp[0]=(toNumber(_tmp[0])+2).toString(),psVersion=_tmp.join("."),delete _tmp}}catch(e){psVersion=version}finally{$.level=lvl,delete lvl}CSVersion=function(){return toNumber(psVersion.match(/^\d+/)[0])-7},CSVersion._version=CSVersion(),isCS6=function(){return CSVersion._version==6},isCS5=function(){return CSVersion._version==5},isCS4=function(){return CSVersion._version==4},isCS3=function(){return CSVersion._version==3},isCS2=function(){return CSVersion._version==2},isCS=function(){return CSVersion._version==1},isPS7=function(){return psVersion.match(/^7\./)!=null},isPS7()&&(app=this),isWindows=function(){return $.os.match(/windows/i)},isMac=function(){return!isWindows()},isVista=function(){return $.os.match(/vista/i)},isVista64=function(){return $.os.match(/vista\/64/i)},Stdlib=function(){},Stdlib.RcsId="$Id$",Stdlib.ERROR_CODE=9001,Stdlib.IO_ERROR_CODE=9002,Stdlib.IOEXCEPTIONS_ENABLED=!0,Stdlib.throwError=function(e){throw e},throwError=Stdlib.throwError,Stdlib.quit=function(e){executeAction(cTID("quit"),new ActionDescriptor,DialogModes.NO)},Stdlib.createObject=function(e,t){var n=new e;for(var r in t)n[r]=t[r];return n},Stdlib.clearObject=function(e){for(var t in e)delete e[t];return e},Stdlib.copyFromTo=function(e,t){if(!e||!t)return;for(var n in e){var r=e[n];if(typeof r=="function")continue;if(r=="typename")continue;t[n]=r}},Stdlib.randomElement=function(e){return e[Math.floor(Math.random(e.length)*e.length)]},Stdlib.popRandomElement=function(e){if(e.length==0)return undefined;if(e.length==1){var t=e[0];return e.length=0,t}var n=Math.floor(Math.random(e.length)*e.length),t=e[n];return e.splice(n,1),t},Stdlib.getenv=function(e){e=e.toUpperCase();if(Stdlib.env!=undefined)return e?Stdlib.env[e]:Stdlib.env;Stdlib.env=new Object;var t=new File(Folder.temp+"/getenv.bat");t.open("w"),t.writeln("set > env.txt"),t.writeln("rename env.txt env.dat"),t.close(),t.execute();var n,r=100;while(r--){Stdlib.pause(1e4),n=new File("env.dat");if(n.exists)break;n=undefined}n||Error.runtimeError(33),n.open("r");var i=n.read();n.close(),t.remove(),n.remove();var s=i.split("\n");for(var o=0;o<s.length;o++){var u=s[o].split("=");Stdlib.env[u[0].toUpperCase()]=u[1]}return e?Stdlib.env[e]:Stdlib.env},Stdlib.IncludePathFile="IncludePath.js",Stdlib.runScript=function(e){Stdlib.runScriptByName(e,e.charAt(0)=="/"?null:Stdlib.IncludePathFile)},Stdlib.runScriptByName=function(name,path){var str='//@include "'+name+'";\r';return path&&(str='//@include "'+path+'";\r'+str),eval(str),!0},Stdlib.getScriptFolder=function(){return Stdlib.getScriptFile().parent},Stdlib.getScriptFileName=function(){var e=Stdlib.getScriptFile();return e?e.absoluteURI:""},Stdlib.getScriptFile=function(){if(isCS()||isPS7())return undefined;if(isCS2()){var e=$.level;$.level=0;var t=undefined;try{some_undefined_variable}catch(n){t=n.fileName}return $.level=e,new File(t)}return new File($.fileName)},Stdlib.btRunScript=function(e,t){t||(t=BridgeTalk.appSpecifier),BridgeTalk.bringToFront(t);var n=new BridgeTalk;n.target=t,n.body='//@include "'+e+'";\r\n',n.send()},Stdlib.btExec=function(e,t){t||(t=BridgeTalk.appSpecifier),BridgeTalk.bringToFront(t);var n=new BridgeTalk;n.target=t,n.body=e,n.send()},Stdlib.restartScript=function(){Stdlib.btRunScript(Stdlib.getScriptFileName())};try{Stdlib.PRESETS_FOLDER=new Folder(app.path+"/"+localize("$$$/ApplicationPresetsFolder/Presets=Presets")),Stdlib.ADOBE_PRESETS_FOLDER=Stdlib.PRESETS_FOLDER,Stdlib.USER_PRESETS_FOLDER=new Folder(Folder.userData+"/"+localize("$$$/private/AdobeSystemFolder/Adobe=Adobe")+"/"+localize("$$$/private/FolderNames/AdobePhotoshopProductVersionFolder")+"/"+localize("$$$/private/FolderName/UserPresetsFolder/Presets=Presets")),Stdlib.SCRIPTS_FOLDER=new Folder(app.path+"/"+localize("$$$/ScriptingSupport/InstalledScripts=Presets/Scripts")),Stdlib.PLUGINS_FOLDER=new Folder(app.path+"/"+localize("$$$/private/Plugins/DefaultPluginFolder=Plug-Ins")),Stdlib.FLASH_PANELS_FOLDER=new Folder(Stdlib.PLUGINS_FOLDER+"/"+localize("$$$/private/Plugins/FlashFolder=Panels")),Stdlib.PS_SETTINGS_FOLDER=new Folder(app.preferencesFolder+"/"+localize("$$$/private/WorkSpace/WorkSpaceFolder/WorkSpace=WorkSpaces"))}catch(e){}Stdlib._getPreferencesFolder=function(){var e=Folder.userData;if(!e||!e.exists)e=Folder("~");var t=new Folder(e+"/xtools");return t.exists||t.create(),t},Stdlib.PREFERENCES_FOLDER=Stdlib._getPreferencesFolder(),Stdlib.selectWorkSpace=function(e){var t=new ActionDescriptor,n=new ActionReference;n.putName(sTID("workspace"),e),t.putReference(cTID("null"),n),executeAction(cTID("slct"),t,DialogModes.NO)},Stdlib.toISODateString=function(e,t,n,r){function s(e){return e<10?"0"+e:e}e||(e=new Date);var i="";t==undefined&&(t="T");if(e instanceof Date){i=e.getFullYear()+"-"+s(e.getMonth()+1,2)+"-"+s(e.getDate(),2);if(!n){i+=t+s(e.getHours(),2)+":"+s(e.getMinutes(),2)+":"+s(e.getSeconds(),2);if(r&&typeof r=="number"){var o=e.getMilliseconds();if(o){var u=s(o.toString(),r),a=u.slice(0,Math.min(r,u.length));i+="."+a}}}}return i},Date.prototype.toISODateString=function(e,t,n){return Stdlib.toISODateString(this,e,t,n)},Date.prototype.toISOString=Date.prototype.toISODateString,Stdlib.testISODate=function(){var e=["2006-09-01","1997-07-16T19:20","1997-07-16T19:20Z","1997-07-16T19:20+01:00","2006-09-01T16:33:26","2006-09-01 16:33:26","2006:09:01 16:33:26","1997-07-16T19:20:30","1997-07-16T19:20:30Z","1997-07-16T19:20:30-01:00","1997-07-16T19:20:30.45","1997-07-16T19:20:30.45Z","1997-07-16T19:20:30.45+01:05"];for(var t=0;t<e.length;t++){var n=e[t];alert(n+" :: "+Stdlib.parseISODateString(n).toISODateString("T",!1,2))}},Stdlib.parseISODateString=function(e){if(!e)return undefined;var t=undefined;if(e.length>=10&&e.length<=35){var n=e.endsWith("Z"),r=e.match(/^(\d{4}).?(\d{2}).?(\d{2})/);if(r){var t=new Date;n?(t.setUTCFullYear(Number(r[1]),Number(r[2])-1,Number(r[3])),t.setUTCHours(0,0,0),t.setUTCMilliseconds(0)):(t.setFullYear(Number(r[1]),Number(r[2])-1,Number(r[3])),t.setHours(0,0,0),t.setMilliseconds(0));if(e.length>10){r=e.match(/( |T)(\d{2}):(\d{2})(?::(\d{2})(\.\d+)?)?(?:(Z)|(\-|\+)(\d{2}):(\d{2}))?$/);if(r){var i=Number(r[2]),s=Number(r[3]),o=e.slice(r.index),u=r[4]?Number(r[4]):0,a=0;r[5]&&(a=Number("0"+r[5])*1e3);var f=r[6]=="Z";n?(t.setUTCHours(i,s,u),t.setUTCMilliseconds(a)):(t.setHours(i,s,u),t.setMilliseconds(a));if(r[6]||r[7]&&r[8]&&r[9]){var l=f?"Z":r[7]+r[8]+":"+r[9];t.tzd=l}}else t=undefined}}}return t},Stdlib.binToHex=function(e,t){function n(e){return e<10?e.toString():(e-=10,String.fromCharCode("A".charCodeAt(0)+e))}var r="";e.constructor!=String&&(e=e.toString());for(var i=0;i<e.length;i++){i&&t==1&&(i&15?i&3||(r+=" "):r+="\r\n");var s=e.charCodeAt(i)&255;r+=n(s>>4)+n(s&15)}return r},Stdlib.hexToBin=function(e){function t(e){return e.match(/[0-9]/)?parseInt(e):parseInt(e.charCodeAt(0)-"A".charCodeAt(0)+10)}e=e.toUpperCase().replace(/\s/g,"");var n="";for(var r=0;r<e.length/2;r++){var i=e.charAt(r*2),s=e.charAt(r*2+1),o=(t(i)<<4)+t(s);n+=String.fromCharCode(o)}return n},Stdlib.hexToJS=function(e){var t="",n=64,r=(e.length/n).toFixed();for(var i=0;i<r;i++){var s=i*n;t+='  "'+e.slice(s,s+n)+'" +\n'}return t+='  "'+e.slice(r*n)+'"\n',t},Stdlib.shortToHex=function(e){function t(e){return String.fromCharCode(e)}var n=[t(e>>8&255),t(e&255)];return Stdlib.binToHex(n.join(""))},Stdlib.longToHex=function(e){function t(e){return String.fromCharCode(e)}var n=[t(e>>24&255),t(e>>16&255),t(e>>8&255),t(e&255)];return Stdlib.binToHex(n.join(""))},Stdlib.hexToLong=function(e){function t(e,t){return e.charCodeAt(t)}var n=Stdlib.hexToBin(e);return(t(n,0)<<24)+(t(n,1)<<16)+(t(n,2)<<8)+t(n,3)},Stdlib.hexTest=function(){var f=new File("/c/work/xxx.asl"),s=Stdlib.readFromFile(f,"BINARY"),h=Stdlib.binToHex(s),js=Stdlib.hexToJS(h);eval(" xxx = "+js),alert(xxx==h);var f=new File("/c/work/xxx2.asl");Stdlib.writeToFile(f,Stdlib.hexToBin(xxx),"BINARY")},Stdlib.numberToAscii=function(e){if(isNaN(e))return e;var t=String.fromCharCode(e>>24)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255);return Stdlib.isAscii(t[0])&&Stdlib.isAscii(t[1])&&Stdlib.isAscii(t[2])&&Stdlib.isAscii(t[3])?t:e},Stdlib.ASCII_SPECIAL="\r\n !\"#$%&'()*+,-./:;<=>?@[]^_`{|}~",Stdlib.isSpecialChar=function(e){return Stdlib.ASCII_SPECIAL.contains(e[0])},Stdlib.isAscii=function(e){return!!e.match(/[\w\s]/)||!!Stdlib.isSpecialChar(e)},String.prototype.contains=function(e){return this.indexOf(e)!=-1},String.prototype.containsWord=function(e){return this.match(new RegExp("\\b"+e+"\\b"))!=null},String.prototype.endsWith=function(e){return this.length>=e.length&&this.slice(this.length-e.length)==e},String.prototype.reverse=function(){var e=this.split("");return e.reverse(),e.join("")},String.prototype.startsWith=function(e){return this.indexOf(e)==0},String.prototype.trim=function(){return this.replace(/^[\s]+|[\s]+$/g,"")},String.prototype.ltrim=function(){return this.replace(/^[\s]+/g,"")},String.prototype.rtrim=function(){return this.replace(/[\s]+$/g,"")},Stdlib.trim=function(e){return e.replace(/^[\s]+|[\s]+$/g,"")},Array.contains=function(e,t){for(var n=0;n<e.length;n++)if(e[n]==t)return!0;return!1},Array.prototype.contains||(Array.prototype.contains=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return!0;return!1}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return t;return-1}),Array.prototype.lastIndexOf||(Array.prototype.indexOf=function(e){for(var t=this.length-1;t>=0;t--)if(this[t]==e)return t;return-1}),Stdlib.fileError=function(e,t){return"IOError: "+(t||"")+' "'+e+'": '+e.error+"."},Stdlib.convertFptr=function(e){var t;try{e instanceof XML&&(e=e.toString())}catch(n){}return e.constructor==String?t=File(e):e instanceof File||e instanceof Folder?t=e:Error.runtimeError(19,"fptr"),t},Stdlib.createFileSelect=function(e){function i(e){var t=decodeURI(e.absoluteURI).toLowerCase(),n=i.exts;while(e.alias){try{e=e.resolve()}catch(r){e=null}if(e==null)return!1}if(e instanceof Folder)return!0;for(var s=0;s<n.length;s++){var o=n[s];if(o==".*")return!0;if(t.match(RegExp("\\."+o+"$","i"))!=null)return!0}return!1}if(isWindows())return e;if(!e.constructor==String)return e;var t=[],n=/\*\.(\*|[\w]+)(.*)/,r;while(r=n.exec(e))t.push(r[1].toLowerCase()),e=r[2];return i.exts=t,i},Stdlib.selectFileOpen=function(e,t,n){return Stdlib._selectFile(e,t,n,!0)},Stdlib.selectFileSave=function(e,t,n){return Stdlib._selectFile(e,t,n,!1)},Stdlib.selectFile=Stdlib.selectFileOpen,Stdlib._selectFile=function(e,t,n,r){var i;e||(e="Select a file"),n&&(n=Stdlib.convertFptr(n));var s=r?File.openDialog:File.saveDialog;if(!n)i=s(e,t);else{if(n instanceof Folder){while(n&&!n.exists)n=n.parent;var o=n.getFiles(t);if(!o||o.length==0)o=n.getFiles();for(var u=0;u<o.length;u++)if(o[u]instanceof File){n=o[u];break}n instanceof Folder&&(n=new File(n+"/file.ext"))}if(n instanceof File){var a=r?"openDlg":"saveDlg";if(a in n)i=n[a](e,t);else{try{n.exists&&(Folder.current=n.parent)}catch(f){}i=s(e,t)}}else i=Folder.selectDialog(e)}return i&&(Folder.current=i.parent),i},Stdlib.selectFolder=function(e,t){var n;e||(e="Select a folder");if(t){t=Stdlib.convertFptr(t);while(t&&!t.exists)t=t.parent}if(!t)n=Folder.selectDialog(e);else{t instanceof File&&(t=t.parent);if(t.selectDlg)n=t.selectDlg(e);else{var r=Folder.current;t.exists&&(r=t),n=Folder.selectDialog(e,r)}}return n},Stdlib.ImageFileExtsComplete="8bps,3ds,ai3,ai4,ai5,ai6,ai7,ai8,ai,arw,bmp,cin,cr2,crw,dae,dc2,dc3,dcr,dib,dic,dng,dpx,eps,epsf,epsp,erf,exr,fido,flm,gif,hdr,hrr,icb,jpeg?,jpg,kdc,kmz,m4v,mef,mfw,mos,mov,mp4,mpeg,mrw,nef,obj,orf,pam,pbm,pcd,pct,pcx,pdd,pdf,pdp,pef,pict?,png,pnm,ps(d|b)?,pxr,raf,raw,rgbe,rle,sct,sdpx,sr2,srf,tga,tiff?,u3d,vda,vst,wbmp?,x3f,xyze",Stdlib.ImageFileExtsCompleteRE=new RegExp("\\.("+Stdlib.ImageFileExtsComplete.replace(/,/g,"|")+")$","i"),Stdlib.ImageFileExtsCommon="psd,pdd,jpeg?,jpg,png,8bps,gif,bmp,rle,dib,tiff?,raw,dng,crw,cr2,nef,raf,orf",Stdlib.ImageFileExtsCommonRE=new RegExp("\\.("+Stdlib.ImageFileExtsCommon.replace(/,/g,"|")+")$","i"),Stdlib.RawImageFileExts="arw,cr2,crw,dcr,dng,erf,kdc,mos,mef,mrw,nef,orf,pef,raf,raw,sr2,sraw,sraw1,srf,x3f",Stdlib.RawImageFileExtsRE=new RegExp("\\.("+Stdlib.RawImageFileExts.replace(/,/g,"|")+")$","i"),Stdlib.isImageFile=function(e){return e.toString().match(Stdlib.ImageFileExtsCommonRE)!=null},Stdlib.isRawImageFile=function(e){return e.toString().match(Stdlib.RawImageFileExtsRE)!=null},Stdlib.isPSFileType=Stdlib.isImageFile,Stdlib.isValidImageFile=function(e){function t(e){if(e.name.startsWith("._"))return!1;var t=e.strf("%e").toUpperCase();return t.length>0&&app.windowsFileTypes.contains(t)}function n(e){return app.macintoshFileTypes.contains(e.type)||t(e)}return File.fs=="Macintosh"&&n(e)||File.fs=="Windows"&&t(e)},Stdlib.XPFileSort=function(e){function n(e,n){var r=e.name.match(t),i=n.name.match(t);return r!=null&&i!=null?toNumber(r[1])-toNumber(i[1]):e.name.toLowerCase()<n.name.toLowerCase()?-1:e.name>n.name?1:0}var t=/(\d+)\./;return e.sort(n)},Stdlib.getFiles=function(e,t){var n=[];e=Stdlib.convertFptr(e),e.alias&&(e=e.resolve());var r;Folder.prototype._getFiles?r=function(e,t){return e._getFiles(t)}:r=function(e,t){return e.getFiles(t)};if(t instanceof RegExp){var i=r(e);for(var s=0;s<i.length;s+=1){var o=i[s];decodeURI(o.absoluteURI).match(t)&&n.push(o)}}else if(typeof t=="function"){var i=r(e);for(var s=0;s<i.length;s+=1){var o=i[s];t(o)&&n.push(o)}}else n=r(e,t);return n},Stdlib.getFiles.install=function(){Folder.prototype._getFiles||(Folder.prototype._getFiles=Folder.prototype.getFiles,Folder.prototype.getFiles=function(e){return Stdlib.getFiles(this,e)})},Stdlib.getFiles.uninstall=function(){Folder.prototype._getFiles&&(Folder.prototype.getFiles=Folder.prototype._getFiles,delete Folder.protoype._getFiles)},Stdlib.getFolders=function(e){e.alias&&(e=e.resolve());var t=Stdlib.getFiles(e,function(e){return e instanceof Folder});return t},Stdlib.getFiles.install(),Stdlib.findFiles=function(e,t){e.alias&&(e=e.resolve());var n=Stdlib.getFiles(e,t),r=Stdlib.getFolders(e);for(var i=0;i<r.length;i++){var s=r[i],o=Stdlib.findFiles(s,t);while(o.length>0)n.push(o.shift())}return n},Stdlib.findImageFiles=function(e){return Stdlib.findFiles(e,Stdlib.ImageFileExtsCommonRE)},Folder.prototype.findFiles=function(e){return Stdlib.findFiles(this,e)},Stdlib.getImageFiles=function(e,t,n){e.alias&&(e=e.resolve()),t==undefined&&(t=!1),n==undefined&&(n=!1);var r=n?Stdlib.ImageFileExtsCompleteRE:Stdlib.ImageFileExtsCommonRE;return t?Stdlib.findFiles(e,r):Stdlib.getFiles(e,r)},Stdlib.grep=function(e,t,n,r){e.alias&&(e=e.resolve()),n==undefined&&(n=/.*/);var i=r?Stdlib.findFiles(e,n):Stdlib.getFiles(e,n),s=[];for(var o=0;o<i.length;o++){var u=i[o];if(u instanceof File){var a=Stdlib.readFromFile(u);a.match(t)&&s.push(u)}}return s},Stdlib.compareFiles=function(e,t){e instanceof File||(e=new File(e)),t instanceof File||(t=new File(t));if(!e.exists||!t.exists)return"File(s) do not exist.";if(e.length!=t.length)return"Files are different sizes.";try{e.open("r")||throwFileError(e,"Unable to open input file "),e.encoding="BINARY",t.open("r")||throwFileError(t,"Unable to open input file "),t.encoding="BINARY"}finally{try{e.close()}catch(n){}try{t.close()}catch(n){}}while(!e.eof&&!t.eof&&e.read(1)==t.read(1));return!e.eof||!t.eof?"File contents do not match.":null},Stdlib.writeToFile=function(e,t,n,r){var i=Stdlib.convertFptr(e),s;n&&(i.encoding=n),s=i.open("w"),s||Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(i,"Unable to open output file ")),r&&(i.lineFeed=r);if(isPS7()&&n=="BINARY"){i.lineFeed="unix";var o=0,u="\r",a;while((a=t.indexOf(u,o))!=-1)s=i.write(t.substring(o,a)),!s&&Stdlib.IOEXCEPTIONS_ENABLED&&Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(i)),i.lineFeed="mac",s=i.write(u),!s&&Stdlib.IOEXCEPTIONS_ENABLED&&Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(i)),i.lineFeed="unix",o=a+1;o<t.length&&i.write(t.substring(o))}else s=i.write(t),!s&&Stdlib.IOEXCEPTIONS_ENABLED&&Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(i));s=i.close(),!s&&Stdlib.IOEXCEPTIONS_ENABLED&&Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(i))},Stdlib.readFromFile=function(e,t,n){var r=Stdlib.convertFptr(e),i;i=r.open("r"),i||Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(r,"Unable to open input file ")),t&&(r.encoding=t),n&&(r.lineFeed=n);var s=r.read();return s.length==0&&r.length!=0&&(r.error||(r.error="Probable Character conversion error"),Stdlib.IOEXCEPTIONS_ENABLED&&Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(r))),i=r.close(),!i&&Stdlib.IOEXCEPTIONS_ENABLED&&Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(r)),s},Stdlib.INI_ENCODING="LATIN1",Stdlib.toIniString=function(e){var t="";for(var n in e){if(n.charAt(0)=="_")continue;if(n=="typename")continue;var r=e[n];r==undefined&&(r="");if(r.constructor==String||r.constructor==Number||r.constructor==Boolean||typeof r=="object")t+=n+": "+r.toString()+"\n"}return t},Stdlib.fromIniString=function(e,t){t||(t={});var n=e.split(/[\r\n]+/),r=new RegExp(/([^:]+):(.*)$/);for(var i=0;i<n.length;i++){var s=n[i].trim();if(!s||s.charAt(0)=="#")continue;var o=r.exec(s);if(!o)return alert('Bad line in config file: "'+s+'"'),undefined;t[o[1].trim()]=o[2].trim()}return t},Stdlib.readIniFile=function(e,t){t||(t={}),e=Stdlib.convertFptr(e);if(!e.exists)return t;if(e.open("r","TEXT","????")){e.lineFeed="unix",e.encoding=Stdlib.INI_ENCODING;var n=e.read(),r=e.close();return!r&&Stdlib.IOEXCEPTIONS_ENABLED&&Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(e)),Stdlib.fromIniString(n,t)}return Stdlib.IOEXCEPTIONS_ENABLED&&Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(e)),t},Stdlib.readIniValue=function(e,t){var n=Stdlib.readIniFile(e);return n[t]},Stdlib.writeIniValue=function(e,t,n){var r={};r[t]=n,Stdlib.updateIniFile(e,r)},Stdlib.writeIniFile=function(e,t,n){var r,i=n!=undefined?n:"";i+=Stdlib.toIniString(t);var s=Stdlib.convertFptr(e);s.encoding=Stdlib.INI_ENCODING,r=s.open("w","TEXT","????"),!r&&Stdlib.IOEXCEPTIONS_ENABLED&&Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(s)),s.lineFeed="unix",r=s.write(i),!r&&Stdlib.IOEXCEPTIONS_ENABLED&&Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(s)),r=s.close(),!r&&Stdlib.IOEXCEPTIONS_ENABLED&&Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(s))},Stdlib.updateIniFile=function(e,t){if(!t||!e)return undefined;var n=Stdlib.convertFptr(e),r=n.exists,i="";if(r){n.open("r","TEXT","????"),e.encoding=Stdlib.INI_ENCODING,n.lineFeed="unix",i=n.read(),n.close();for(var s in t){if(s.charAt(0)=="_")continue;if(s=="noUI")continue;if(s=="typename")continue;var o=t[s];typeof o=="undefined"&&(o="");if(typeof o=="string"||typeof o=="number"||typeof o=="boolean"||typeof o=="object"){s+=":";var u=RegExp("^"+s,"m");u.test(i)?(u=RegExp("^"+s+"[^\n]*","m"),i=i.replace(u,s+" "+o)):i+="\n"+s+" "+o}}}else for(var s in t){if(s.charAt(0)=="_")continue;if(s=="noUI")continue;if(s=="typename")continue;var o=t[s];if(typeof o=="string"||typeof o=="number"||typeof o=="boolean"||typeof o=="object")i+=s+": "+o.toString()+"\n"}return i&&(n.open("w","TEXT","????"),e.encoding=Stdlib.INI_ENCODING,n.lineFeed="unix",n.write(i),n.close()),t},Stdlib.xmlFromIni=function(e,t){var n;e==undefined&&Error.runtimeError(2,"ini"),t?t.constructor.name=="String"?n=new XML("<"+t+"></"+t+">"):t instanceof XML?n=t:Error.runtimeError(1243):n=new XML("Ini");for(var r in e){if(r.charAt(0)=="_")continue;if(r=="noUI")continue;if(r=="typename")continue;var i=e[r];if(typeof i=="string"||typeof i=="number"||typeof i=="boolean"||typeof i=="object")n[r]=i}return n},Stdlib.iniFromXML=function(e,t){e||Error.runtimeError(2,"xml"),t||(t={});var n=e.elements();for(var r=0;r<n.length();r++){var i=n[r];t[i.name()]=i.toString()}return t},Stdlib.readXMLFile=function(e){var t,n=Stdlib.convertFptr(e);n.exists||Error.runtimeError(48),n.encoding="UTF8",n.lineFeed="unix",t=n.open("r","TEXT","????"),!t&&Stdlib.IOEXCEPTIONS_ENABLED&&Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(n));var r=n.read();return t=n.close(),!t&&Stdlib.IOEXCEPTIONS_ENABLED&&Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(n)),new XML(r)},Stdlib.writeXMLFile=function(e,t){var n;t instanceof XML||Error.runtimeError(19,"xml");var r=Stdlib.convertFptr(e);return r.encoding="UTF8",n=r.open("w","TEXT","????"),!n&&Stdlib.IOEXCEPTIONS_ENABLED&&Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(r)),r.lineFeed="unix",r.writeln('<?xml version="1.0" encoding="utf-8"?>'),n=r.write(t.toXMLString()),!n&&Stdlib.IOEXCEPTIONS_ENABLED&&Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(r)),n=r.close(),!n&&Stdlib.IOEXCEPTIONS_ENABLED&&Error.runtimeError(Stdlib.IO_ERROR_CODE,Stdlib.fileError(r)),r},Stdlib.fromCSVString=function(e,t,n){return Stdlib.fromCharSVString(e,",",t,n)},Stdlib.readCSVFile=function(e,t,n){return Stdlib.readCharSVFile(e,",",t,n)},Stdlib.fromTSVString=function(e,t,n){return Stdlib.fromCharSVString(e," ",t,n)},Stdlib.readTSVFile=function(e,t,n){return Stdlib.readCharSVFile(e," ",t,n)},Stdlib.fromCharSVString=function(e,t,n,r){function u(e,t){var n=[];e=e.trim();var r;while(e.length&&(r=e.match(o))!=null)if(r[1]||r[2])r[1]?n.push(r[1]):n.push(r[2].replace(/""/g,'"')),e=e.slice(r[0].length+r.index),e[0]==t&&(e=e.slice(1));else for(;;){if(e[0]==t){n.push(""),e=e.slice(1);continue}if(e.startsWith('""')){n.push(""),e=e.slice(2),e[0]==t&&(e=e.slice(1));continue}break}return n}r=!!r,n||(n=[]);var i=e.split(/\r|\n/);if(i.length==0)return n;var s='([^",]+)|"((?:[^"]|"")*)"|^,';t!=","&&(s=s.replace(/,/g,t));var o=new RegExp(s),a=[];if(r){var f=i[0].trim();a=u(f,t),i.shift()}n.headers=a;if(i.length==0)return n;for(var l=0;l<i.length;l++){var c=u(i[l],t);if(c.length==0)continue;if(r){var h=new Object;for(var p=0;p<c.length;p++)a[p]?h[a[p]]=c[p]||"":h[p]=c[p]||"";n.push(h)}else n.push(c)}return n},Stdlib.readCharSVFile=function(e,t,n,r){n||(n=[]),e=Stdlib.convertFptr(e);if(!e.exists)return n;var i=Stdlib.readFromFile(e);return Stdlib.fromCharSVString(i,t,n,r)},Stdlib.writeCSVFile=function(e,t,n){function r(e){var t="",n=/^(\+|\-)?(\d+|\.\d+|\d+\.\d+)$/;for(var r=0;r<e.length;r++){var i=e[r].toString();if(i=="-"||i=="+"||!i.match(numRE))i='"'+i.replace(/"/g,'""')+'"';t+=i,r+1!=e.length&&(t+=",")}return t}e=Stdlib.convertFptr(e),e.lineFeed="unix",e.open("w","TEXT","????")||Error.runtimeError(Stdlib.IO_ERROR_CODE,'IOError: unable to open file "'+e+'": '+e.error+".");if(n){e.writeln(r(n));for(var i=0;i<t.length;i++){var s=t[i],o=[];for(var u=0;u<n.length;u++){var a=n[u],f=s[a];f==undefined&&(f=""),o.push(f)}e.writeln(r(o))}}else for(var i=0;i<t.length;i++){var l=t[i];e.writeln(r(l))}e.close()},Stdlib.createFolder=function(e,t){e||Error.runtimeError(19,"fptr"),e.constructor==String&&(e=new Folder(e));if((!e.exists||e.parent&&!e.parent.exists)&&t){var n=e instanceof File?e.parent:e;if(!confirm(n.toUIString()+" does not exist. Create?"))return!1}return e instanceof File?Stdlib.createFolder(e.parent):e.exists?!0:e.parent&&!e.parent.exists&&!Stdlib.createFolder(e.parent)?!1:e.create()},Stdlib.log=function(e){var t;if(!Stdlib.log.enabled)return;if(!Stdlib.log.filename)return;Stdlib.log.fptr?(t=Stdlib.log.fptr,t.open("e","TEXT","????")||Error.runtimeError(Stdlib.IO_ERROR_CODE,"Unable to open log file(3) "+t+": "+t.error),t.seek(0,2)):(t=new File(Stdlib.log.filename),Stdlib.log.append&&t.exists?(t.open("e","TEXT","????")||Error.runtimeError(Stdlib.IO_ERROR_CODE,"Unable to open log file(1) "+t+": "+t.error),t.seek(0,2)):t.open("w","TEXT","????")||(t.open("e","TEXT","????")||Error.runtimeError(Stdlib.IO_ERROR_CODE,"Unable to open log file(2) "+t+": "+t.error),t.seek(0,0)),Stdlib.log.fptr=t),isMac()&&(t.lineFeed="Unix"),Stdlib.log.encoding&&(t.encoding=Stdlib.log.encoding),e&&(e=e.toString()),t.writeln((new Date).toISODateString()+" - "+e)||Error.runtimeError(Stdlib.IO_ERROR_CODE,"Unable to write to log file(4) "+t+": "+t.error),t.close()},Stdlib.log.filename=Stdlib.PREFERENCES_FOLDER+"/stdout.log",Stdlib.log.enabled=!1,Stdlib.log.encoding="UTF8",Stdlib.log.append=!1,Stdlib.log.setFile=function(e,t){Stdlib.log.filename=e,Stdlib.log.enabled=e!=undefined,Stdlib.log.encoding=t||"UTF8",Stdlib.log.fptr=undefined},Stdlib.log.setFilename=Stdlib.log.setFile,Stdlib._maxMsgLen=5e3,Stdlib.exceptionMessage=function(e){var t="",n=e.fileName?decodeURI(e.fileName):"???";t+="   Message: "+e.message+"\n",t+="   File: "+n+"\n",t+="   Line: "+(e.line||"???")+"\n",t+="   Error Name: "+e.name+"\n",t+="   Error Number: "+e.number+"\n";if(e.source){var r=e.source.split("\n"),i=e.line-10,s=e.line+10,o=e.line-1;i<0&&(i=0),s>r.length&&(s=r.length);for(var u=i;u<s;u++)u==o?t+="   Line: ("+(u+1)+") >> "+r[u]+"\n":t+="   Line: ("+(u+1)+")    "+r[u]+"\n"}try{$.stack&&(t+="\n"+$.stack+"\n")}catch(e){}return t.length>Stdlib._maxMsgLen&&(t=t.substring(0,Stdlib._maxMsgLen)+"..."),Stdlib.log.fptr&&(t+="\nLog File:"+Stdlib.log.fptr.toUIString()),t},Stdlib.logException=function(e,t,n){if(!Stdlib.log.enabled)return;n==undefined&&(n=!1,t==undefined?t="":isBoolean(t)&&(n=t,t="")),n=!!n;var r=(t||"")+"\n"+"==============Exception==============\n"+Stdlib.exceptionMessage(e)+"\n==============End Exception==============\n";Stdlib.log(r),n&&(r+="\r\rMore information can be found in the file:\r    "+Stdlib.log.fptr.toUIString(),alert(r))},Stdlib.getByName=function(e,t,n){t||Error.runtimeError(2,"name");var r;t instanceof RegExp?r=function(e,t){return e.match(t)!=null}:r=function(e,t){return e==t};var i=[];for(var s=0;s<e.length;s++)if(r(e[s].name,t)){if(!n)return e[s];i.push(e[s])}return n?i:undefined},Stdlib.getAllByName=function(e,t){return Stdlib.getByName(e,t,!0)},Stdlib.getByProperty=function(e,t,n,r){t==undefined&&Error.runtimeError(2,"prop"),n==undefined&&Error.runtimeError(2,"value");var i;r=!!r,n instanceof RegExp?i=function(e,t){return e.match(t)!=null}:i=function(e,t){return e==t};var s=[];for(var o=0;o<e.length;o++)if(i(e[o][t],n)){if(!r)return e[o];s.push(e[o])}return r?s:undefined},Stdlib.getByFunction=function(e,t,n){t||Error.runtimeError(2,"matchFtn"),typeof t!="function"&&Error(19,"matchFtn");var r=[];for(var i=0;i<e.length;i++)if(t(e[i])){if(!n)return e[i];r.push(e[i])}return n?r:undefined},Stdlib.setPropertyValues=function(e,t,n){t==undefined&&Error.runtimeError(2,"prop"),n==undefined&&Error.runtimeError(2,"value");var r,i=[];for(var s=0;s<e.length;s++)e[s][t]=n;return},Stdlib.sortByName=function(e){function t(e,t){return e.name<t.name?-1:e.name>t.name?1:0}return e.sort(t)},Stdlib.makeActive=function(e){var t=undefined;if(!e)return undefined;if(e.typename=="Document")t=app.activeDocument,e!=t&&(app.activeDocument=e);else if(e.typename.match(/Layer/)){var n=e.parent;while(n.typename!="Document"&&n)n=n.parent;n||Error.runtimeError(19,"obj"),t=n.activeLayer;if(e!=t){var r=app.activeDocument;app.activeDocument=n;try{n.activeLayer=e}catch(i){$.level=1;debugger}app.activeDocument=r}}return t},Stdlib._restoreDoc=!0,Stdlib._restoreLayer=!0,Stdlib.wrapLC=function(e,t){var n=app.activeDocument;e?n!=e&&(app.activeDocument=e):e=n;var r=undefined;try{r=t(e)}finally{Stdlib._restoreDoc&&n&&app.activeDocument!=n&&(app.activeDocument=n)}return r},Stdlib.wrapLCLayer=function(e,t,n){var r=app.activeDocument;e?r!=e&&(app.activeDocument=e):e=r;var i=e.activeLayer,s=i.visible;t&&e.activeLayer!=t?e.activeLayer=t:t=e.activeLayer;var o=undefined;try{o=n(e,t)}finally{Stdlib._restoreLayer&&(e.activeLayer!=i&&(e.activeLayer=i),e.activeLayer.isBackgroundLayer||(e.activeLayer.visible=s)),Stdlib._restoreDoc&&app.activeDocument!=r&&(app.activeDocument=r)}return o},Stdlib.doEvent=function(e,t,n,r){function s(){var e=n?DialogModes.ALL:DialogModes.NO,t=r?undefined:new ActionDescriptor;return app.executeAction(i,t,e)}var i;return e!=undefined&&t==undefined&&(e.constructor==Number?t=e.valueOf():e.constructor==String&&(t=e),e=undefined),t||Error.runtimeError(8600),t.constructor!=Number?(t.length<4&&Error.runtimeError(19,"eventID"),t.length==4?i=cTID(t):i=sTID(t)):i=t,n=n==1,r=r==1,e?Stdlib.wrapLC(e,s):s(i)},Stdlib.doMenuItem=function(e,t){var n=new ActionDescriptor,r=new ActionReference;e.constructor==String&&(e=xTID(e)),r.putEnumerated(cTID("Mn  "),cTID("MnIt"),e),n.putReference(cTID("null"),r);var i=$.level;$.level=0;try{var s=t!=1?DialogModes.NO:DialogModes.ALL;executeAction(sTID("select"),n,s)}catch(o){$.level=i;if(o.number!=8007)throw o;return!1}return $.level=i,!0},Stdlib._print=function(){var e=DialogModes.NO,t=new ActionDescriptor;t.putBoolean(cTID("PstS"),!0),t.putEnumerated(cTID("Inte"),cTID("Inte"),cTID("Clrm")),executeAction(cTID("Prnt"),t,e)},Stdlib.print=function(e){if(isCS4()||isCS5()){function t(){app.bringToFront(),e.printSettings.flip=!1,e.printSettings.setPagePosition(DocPositionStyle.SIZETOFIT),e.printSettings.negative=!1,e.printOneCopy()}Stdlib.wrapLC(e,t)}else{function t(){Stdlib._print()}Stdlib.wrapLC(e,t)}},PSClass={},PSClass.BlurTool=cTID("BlTl"),PSClass.BurnInTool=cTID("BrTl"),PSClass.CloneStampTool=cTID("ClTl"),PSClass.DodgeTool=cTID("DdTl"),PSClass.EraserTool=cTID("ErTl"),PSClass.GradientTool=cTID("GrTl"),PSClass.HistoryBrushTool=cTID("HBTl"),PSClass.MagicEraserTool=cTID("MgEr"),PSClass.PaintbrushTool=cTID("PbTl"),PSClass.PatternStampTool=cTID("PaTl"),PSClass.PencilTool=cTID("PcTl"),PSClass.SaturationTool=cTID("SrTl"),PSClass.SharpenTool=cTID("ShTl"),PSClass.BackgroundEraserTool=cTID("SETl"),PSClass.ArtHistoryBrushTool=cTID("ABTl"),PSClass.SmudgeTool=cTID("SmTl"),Stdlib.selectTool=function(e){if(!Stdlib.selectTool.map){var t={};t[ToolType.ARTHISTORYBRUSH]=cTID("ABTl"),t[ToolType.BACKGROUNDERASER]=cTID("SETl"),t[ToolType.BLUR]=cTID("BlTl"),t[ToolType.BRUSH]=cTID("PbTl"),t[ToolType.BURN]=cTID("BrTl"),t[ToolType.CLONESTAMP]=cTID("ClTl"),t[ToolType.COLORREPLACEMENTTOOL]=sTID("colorReplacementTool"),t[ToolType.DODGE]=cTID("DdTl"),t[ToolType.ERASER]=cTID("ErTl"),t[ToolType.HEALINGBRUSH]=sTID("magicStampTool"),t[ToolType.HISTORYBRUSH]=cTID("HBTl"),t[ToolType.PATTERNSTAMP]=cTID("PaTl"),t[ToolType.PENCIL]=cTID("PcTl"),t[ToolType.SHARPEN]=cTID("ShTl"),t[ToolType.SMUDGE]=cTID("SmTl"),Stdlib.selectTool.map=t}var n;if(e.toString().startsWith("ToolType")){var r=Stdlib.selectTool.map[e];if(r==undefined){var i={};i._name=e.substring(9),i.toString=function(){return"ToolType."+this._name.toUpperCase()},ToolType[i._name]=i,Stdlib.selectTool.map[ToolType[i._name]]=xTID(i._name),r=Stdlib.selectTool.map[e]}n=r}else isNumber(e)?n=e:e.constructor==String?n=xTID(e):Error.runtimeError(9001,"Bad ToolType specified");var s=new ActionDescriptor,o=new ActionReference;o.putClass(n),s.putReference(cTID("null"),o),executeAction(cTID("slct"),s,DialogModes.NO)},Stdlib.getCurrentTool=function(){var e=new ActionReference;e.putEnumerated(cTID("capp"),cTID("Ordn"),cTID("Trgt"));var t=executeActionGet(e),n=t.getEnumerationType(sTID("tool"));return typeIDToStringID(n)},Stdlib.getCurrentToolOptions=function(){var e=new ActionReference;e.putEnumerated(cTID("capp"),cTID("Ordn"),cTID("Trgt"));var t=executeActionGet(e);return t.hasKey(cTID("CrnT"))?t.getObjectValue(cTID("CrnT")):undefined},Stdlib.zoomIn=function(){Stdlib.doMenuItem("ZmIn")},Stdlib.zoomOut=function(){Stdlib.doMenuItem("ZmOt")},Stdlib.zoomActualPixels=function(){Stdlib.doMenuItem("ActP")},Stdlib.zoomFitOnScreen=function(){Stdlib.doMenuItem("FtOn")},Stdlib.zoomPrintSize=function(){Stdlib.doMenuItem("PrnS")},Stdlib.setZoom=function(e,t){function r(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Mn  "),cTID("MnIt"),cTID("PrnS")),e.putReference(cTID("null"),t),executeAction(cTID("slct"),e,DialogModes.NO)}var n=e.resolution;return e.resizeImage(undefined,undefined,72/(t/100),ResampleMethod.NONE),Stdlib.wrapLC(e,r)},Stdlib.resetSwatches=function(){var e=new ActionDescriptor,t=new ActionReference;t.putProperty(cTID("Clr "),cTID("Clrs")),e.putReference(cTID("null"),t),executeAction(cTID("Rset"),e,DialogModes.NO)},Stdlib.newDocument=function(e,t,n,r,i,s,o){function u(e,t,n,r,i,s){var u=new ActionDescriptor;u.putString(cTID("Nm  "),e),u.putClass(cTID("Md  "),cTID(t)),u.putUnitDouble(cTID("Wdth"),cTID("#Rlt"),n),u.putUnitDouble(cTID("Hght"),cTID("#Rlt"),r),u.putUnitDouble(cTID("Rslt"),cTID("#Rsl"),i),u.putDouble(sTID("pixelScaleFactor"),1),u.putEnumerated(cTID("Fl  "),cTID("Fl  "),cTID("Wht ")),u.putInteger(cTID("Dpth"),s),u.putString(sTID("profile"),o);var a=new ActionDescriptor;a.putObject(cTID("Nw  "),cTID("Dcmn"),u),executeAction(cTID("Mk  "),a,DialogModes.NO)}return o||(o=ColorProfileNames.SRGB),u(e,t,n,r,i,s),app.activeDocument},Stdlib.newDocumentFromClipboard=function(e){function t(){var t=new ActionDescriptor,n=new ActionDescriptor;e&&n.putString(cTID("Nm  "),e),n.putString(sTID("preset"),"Clipboard"),t.putObject(cTID("Nw  "),cTID("Dcmn"),n),executeAction(cTID("Mk  "),t,DialogModes.NO)}function n(){var e=new ActionDescriptor;e.putEnumerated(cTID("AntA"),cTID("Annt"),cTID("Anno")),executeAction(cTID("past"),e,DialogModes.NO)}var r;if(isCS2()||isCS3()){e||(e="Untitled"),r=app.documents.add(UnitValue(100,"px"),UnitValue(100,"px"),72,e,NewDocumentMode.RGB),n();var i=r.activeLayer,s=Stdlib.getLayerBounds(r,i);r.resizeCanvas(UnitValue(s[2],"px"),UnitValue(s[3],"px")),n()}else t(),n(),r=app.activeDocument;return r.flatten(),r},Stdlib.getObjectProperty=function(e,t,n){var r=Stdlib._getObjProperty(e,t,n);return r?r.value:undefined},Stdlib.getObjectPropertyType=function(e,t,n){var r=Stdlib._getObjProperty(e,t,n);return r?r.type:undefined},Stdlib._getObjProperty=function(e,t,n){function s(e,t,n){var r=new ActionReference;r.putProperty(cTID("Prpr"),t),typeof e=="number"?r.putIndex(cTID(n),e):r.putEnumerated(cTID(n),cTID("Ordn"),cTID("Trgt"));var i;try{i=executeActionGet(r)}catch(s){return undefined}var o={};if(i.hasKey(t)){var u=i.getType(t);switch(u){case DescValueType.ALIASTYPE:o.value=i.getPath(t);break;case DescValueType.BOOLEANTYPE:o.value=i.getBoolean(t);break;case DescValueType.CLASSTYPE:o.value=i.getClass(t);break;case DescValueType.DOUBLETYPE:o.value=i.getDouble(t);break;case DescValueType.ENUMERATEDTYPE:o.value=i.getEnumeratedValue(t),o.type=i.getEnumeratedType(t);break;case DescValueType.INTEGERTYPE:o.value=i.getInteger(t);break;case DescValueType.LISTTYPE:o.value=i.getList(t);break;case DescValueType.OBJECTTYPE:o.value=i.getObjectValue(t),o.type=i.getObjectType(t);break;case DescValueType.RAWTYPE:o.value=i.getData(t);break;case DescValueType.REFERENCETYPE:o.value=i.getReference(t);break;case DescValueType.STRINGTYPE:o.value=i.getString(t);break;case DescValueType.UNITDOUBLE:o.value=i.getUnitDoubleValue(t),o.type=i.getUnitDoubleType(t)}}return o}var r,i;e==undefined&&Error.runtimeError(2,"object"),t==undefined&&Error.runtimeError(2,"property"),t.constructor==String?r=xTID(t):t.constructor==Number?r=t:Error.runtimeError(19,"property");var o;if(app.documents.length>0)var u=app.activeDocument,a=u.activeLayer;if(typeof e=="object")if(n=="Dcmn"||e.typename=="Document")i="Dcmn",app.activeDocument!=e&&(u=app.activeDocument,app.activeDocument=e);else if(n=="Lyr "||e.typename=="ArtLayer"||e.typename=="LayerSet"){i="Lyr ";var f=e;while(f.parent!=undefined&&f.parent.typename!="Document")f=f.parent;app.activeDocument!=f.parent&&(app.activeDocument=f.parent),f.parent.activeLayer!=e&&(f.parent.activeLayer=e)}else n=="capp"||e.typename=="Application"?i="capp":Error.runtimeError(55,t);else typeof e=="number"&&(n||Error.runtimeError(55,t),n!="Lyr "&&n!="Dcmn"&&Error.runtimeError(9001,"Indexed app operations are not yet supported."),i=n);var o=s(e,r,i);return app.documents.length>0&&(u.activeLayer!=a&&(u.activeLayer=a),app.activeDocument!=u&&(app.activeDocument=u)),o},Stdlib.getLayerProperty=function(e,t){return Stdlib.getObjectProperty(e,t,"Lyr ")},Stdlib.getDocumentProperty=function(e,t){return Stdlib.getObjectProperty(e,t,"Dcmn")},Stdlib.getApplicationProperty=function(e){return Stdlib.getObjectProperty(app,e)},Stdlib.duplicateDocument=function(e,t,n){function r(){var e=new ActionDescriptor,r=new ActionReference;return r.putEnumerated(cTID("Dcmn"),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),r),t&&e.putString(cTID("Nm  "),t),n==1&&e.putBoolean(cTID("Mrgd"),!0),executeAction(cTID("Dplc"),e,DialogModes.NO),app.activeDocument}return Stdlib.wrapLC(e,r)},Stdlib.getDocumentDescriptor=function(e){function t(){var e=new ActionReference;return e.putEnumerated(cTID("Dcmn"),cTID("Ordn"),cTID("Trgt")),executeActionGet(e)}return Stdlib.wrapLC(e,t)},Stdlib.getDocumentIndex=function(e){return Stdlib.getDocumentProperty(e,cTID("ItmI"))},Stdlib.isDocumentNew=function(e){var t=Stdlib.getDocumentDescriptor(e),n=!0;if(t.hasKey(cTID("FilR"))){var r=t.getPath(cTID("FilR"));r&&(n=r.absoluteURI.length==0)}return n},Stdlib.hasBackground=function(e){return e.layers[e.layers.length-1].isBackgroundLayer},Stdlib.hasBackgroundLayer=Stdlib.hasBackground,Stdlib.isDocumentOpen=function(e){if(e&&app.documents.length>0){var t=Stdlib.getByName(app.documents,e.name);if(t)return e==t.fullName}return!1},Stdlib.getDocumentName=function(e){function t(){var e=new ActionReference;e.putProperty(cTID("Prpr"),cTID("FilR")),e.putEnumerated(cTID("Dcmn"),cTID("Ordn"),cTID("Trgt"));var t=executeActionGet(e);return t.hasKey(cTID("FilR"))?t.getPath(cTID("FilR")):undefined}return Stdlib.wrapLC(e,t)},Stdlib.getDocumentFile=function(e){return Stdlib.getDocumentName(e)},Stdlib.revertDocument=function(e){Stdlib.doEvent(e,"Rvrt")},Stdlib.isLandscapeMode=function(e){var t=app.preferences.rulerUnits;app.preferences.rulerUnits=Units.PIXELS;var n=e.width.value>e.height.value;return app.preferences.rulerUnits=t,n},Stdlib.isPortraitMode=function(e){var t=app.preferences.rulerUnits;app.preferences.rulerUnits=Units.PIXELS;var n=e.width.value<e.height.value;return app.preferences.rulerUnits=t,n},Stdlib.isSquareMode=function(e){var t=app.preferences.rulerUnits;app.preferences.rulerUnits=Units.PIXELS;var n=e.width.value==e.height.value;return app.preferences.rulerUnits=t,n},Stdlib.validateUnitValue=function(e,t,n){var r=this;if(e instanceof UnitValue)return e;if(t&&t instanceof Document){var i=t;n=i.width.type,t=UnitValue(1/i.resolution,n)}else n||(n=Stdlib.getDefaultRulerUnitsString()),t||(UnitValue.baseUnit=UnitValue(1/72,n));e=e.toString().toLowerCase();var s=new UnitValue("0 "+n),o=s;return e.match(/[a-z%]+/)||(e+=" "+n.units),o=new UnitValue(e),isNaN(o.value)||o.type=="?"?undefined:(o.value==0&&(o=s),o)},Stdlib.openDialogPS7=function(e){return Stdlib.selectImageFile(e)},Stdlib.selectImageFile=function(e){var t,n=undefined;documents.length&&(t=app.activeDocument),e?(e=Stdlib.convertFptr(e),e.exists||(e=e.parent)):e=Folder.current;if(e instanceof Folder){var r=Stdlib.getImageFiles(e,!1,!0);r.length>0?e=r[0]:e=new File(e+"/untitled.psd")}try{var i=new ActionDescriptor;Folder.current=e.parent,i.putPath(cTID("null"),e),executeAction(cTID("Opn "),i,DialogModes.ALL)}catch(s){throw s}return t!=app.activeDocument&&(n=app.activeDocument),n},Stdlib.pasteInto=function(e){function t(){var e=new ActionDescriptor;e.putEnumerated(cTID("AntA"),cTID("Annt"),cTID("Anno")),executeAction(cTID("PstI"),e,DialogModes.NO)}Stdlib.wrapLC(e,t)},Stdlib.takeSnapshot=function(e,t){function n(){var e=new ActionDescriptor,n=new ActionReference;n.putClass(cTID("SnpS")),e.putReference(cTID("null"),n);var r=new ActionReference;r.putProperty(cTID("HstS"),cTID("CrnH")),e.putReference(cTID("From"),r),t&&e.putString(cTID("Nm  "),t),e.putEnumerated(cTID("Usng"),cTID("HstS"),cTID("FllD")),executeAction(cTID("Mk  "),e,DialogModes.NO)}Stdlib.wrapLC(e,n)},Stdlib.revertToSnapshot=function(e,t){function n(){if(!t)return Stdlib.revertToLastSnapshot(e);var n=Stdlib.getByName(e.historyStates,t);return n?(e.activeHistoryState=n,!0):!1}return Stdlib.wrapLC(e,n)},Stdlib.revertToLastSnapshot=function(e){function t(){var t=Stdlib.getByName(e.historyStates,/^Snapshot /,!0);return t.length>0?(e.activeHistoryState=t.pop(),!0):!1}return Stdlib.wrapLC(e,t)},Stdlib.deleteSnapshot=function(e,t){function n(){var e=new ActionDescriptor,n=new ActionReference;n.putName(cTID("SnpS"),t),e.putReference(cTID("null"),n),executeAction(cTID("Dlt "),e,DialogModes.NO)}return Stdlib.wrapLC(e,n)},Stdlib.hist=function(e){function t(){var t=new ActionDescriptor,n=new ActionReference;n.putEnumerated(cTID("HstS"),cTID("Ordn"),cTID(e)),t.putReference(cTID("null"),n),executeAction(cTID("slct"),t,DialogModes.NO)}t()},Stdlib.undo=function(){Stdlib.hist("Prvs")},Stdlib.redo=function(){Stdlib.hist("Nxt ")},Stdlib.Undo=function(){Stdlib.doEvent("undo")},Stdlib.Redo=function(){Stdlib.doEvent(sTID("redo"))},Stdlib.suspendHistory=function(e,t,n){e.suspendHistory(t,n),app.activeDocument=app.activeDocument},Stdlib.NOP=function(){try{app.activeDocument=app.activeDocument}catch(e){}},Stdlib.convertTextLayerToShape=function(e,t){function n(){t.kind!=LayerKind.TEXT&&Error.runtimeError(8177);var e=new ActionDescriptor,n=new ActionReference;n.putClass(sTID("contentLayer")),e.putReference(cTID("null"),n);var r=new ActionReference;r.putEnumerated(cTID("TxLr"),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("Usng"),r),executeAction(cTID("Mk  "),e,DialogModes.NO)}return Stdlib.makeActive(e),Stdlib.makeActive(t),n(),e.activeLayer},Stdlib.copyLayerToDocument=function(e,t,n){function r(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t);var r=new ActionReference;r.putIndex(cTID("Dcmn"),Stdlib.getDocumentIndex(n)),e.putReference(cTID("T   "),r),e.putInteger(cTID("Vrsn"),2),executeAction(cTID("Dplc"),e,DialogModes.NO)}t?Stdlib.wrapLCLayer(e,t,r):Stdlib.wrapLC(e,r)},Stdlib.convertToSmartLayer=function(e,t){function n(){Stdlib.doEvent(sTID("newPlacedLayer"))}Stdlib.wrapLCLayer(e,t,n)},Stdlib.getSmartObjectType=function(e,t){function n(){var e=undefined,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),sTID("Trgt"));var n=executeActionGet(t);if(n.hasKey(sTID("smartObject"))){var n=executeActionGet(t),r=n.getObjectValue(sTID("smartObject")),i=r.getEnumerationValue(sTID("placed"));e=id2char(i,"Enum")}return e}var r=Stdlib.wrapLCLayer(e,t,n);return r},Stdlib.getSmartObjectFile=function(e,t){function n(){var e=undefined,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),sTID("Trgt"));var n=executeActionGet(t);if(n.hasKey(sTID("smartObject"))){var r=n.getObjectValue(sTID("smartObject"));e=r.getString(sTID("FilR"))}return e}var r=Stdlib.wrapLCLayer(e,t,n);return r},Stdlib.editSmartObject=function(e,t){function n(){var e=sTID("placedLayerEditContents"),t=new ActionDescriptor;executeAction(e,t,DialogModes.NO)}return Stdlib.makeActive(e),Stdlib.makeActive(t),n(),app.activeDocument},Stdlib.updateSmartLayer=function(e,t){function n(){executeAction(sTID("updatePlacedLayer"),undefined,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,n)},Stdlib.replaceSmartLayerContents=function(e,t,n){function r(){var e=Stdlib.convertFptr(n),t=new ActionDescriptor;t.putPath(cTID("null"),e),executeAction(sTID("placedLayerReplaceContents"),t,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,r)},Stdlib.exportSmartLayer=function(e,t,n){function r(){var e=app.displayDialogs;app.displayDialogs=DialogModes.NO;try{var t=new ActionDescriptor;t.putPath(cTID("null"),n),executeAction(sTID("placedLayerExportContents"),t,DialogModes.NO)}finally{app.displayDialogs=e}}n=Stdlib.convertFptr(n),n.remove(),Stdlib.wrapLCLayer(e,t,r)},Stdlib.traverseLayers=function(e,t,n,r){function i(e,t,n,r,s){var o=!0;for(var u=1;u<=t.length&&o!=0;u++){var a=r==1?t.length-u:u-1,f=t[a];if(f.typename=="LayerSet")s&&(o=n(e,f)),o&&(o=i(e,f.layers,n,r,s));else{o=n(e,f);try{app.activeDocument!=e&&(app.activeDocument=e)}catch(l){}}}return o}return i(e,e.layers,t,n,r)},Stdlib.getLayersList=function(e,t,n){function r(e,t){return r.list.push(t),!0}r.list=[],Stdlib.traverseLayers(e,r,t,n);var i=r.list;return r.list=undefined,i},Stdlib.getVisibleLayers=function(e){var t=Stdlib.getLayersList(e);return Stdlib.getByProperty(t,"visible",!0,!0)},Stdlib._setSelLayerVis=function(e,t){function n(){var e=new ActionDescriptor,n=new ActionList,r=new ActionReference;r.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),n.putReference(r),e.putList(cTID("null"),n),executeAction(cTID(t),e,DialogModes.NO)}Stdlib.wrapLC(e,n)},Stdlib.hideSelectedLayers=function(e){Stdlib._setSelectLayerVis(e,"Hd  ")},Stdlib.showSelectedLayers=function(e){Stdlib._setSelectLayerVis(e,"Shw ")},Stdlib._setOtherLayerVis=function(e,t,n){function r(e,t){var n=new ActionDescriptor,r=new ActionReference;r.putIndex(cTID("Lyr "),t),n.putReference(cTID("null"),r),n.putEnumerated(sTID("selectionModifier"),sTID("selectionModifierType"),sTID("addToSelectionContinuous")),n.putBoolean(cTID("MkVs"),!1),executeAction(cTID("slct"),n,DialogModes.NO)}var i=e.layers[0],s=t.visible,o=Stdlib.getLayerIndex(e,t),u=e.layers[e.layers.length-1];e.activeLayer=i;var a=Stdlib.getLayerIndex(e,u);r(e,a),Stdlib._setSelLayerVis(e,n),Stdlib.selectLayerByIndex(e,o),t.visible=s},Stdlib.showOtherLayers=function(e,t){Stdlib._setOtherLayerVis(e,t,"Shw ")},Stdlib.hideOtherLayers=function(e,t){Stdlib._setOtherLayerVis(e,t,"Hd  ")},Stdlib.findLayer=function(e,t){function n(e,t){return n.matchFtn(t.name,n.layerName)?(n.layer=t,!1):!0}var r;return t instanceof RegExp?r=function(e,t){return e.match(t)!=null}:r=function(e,t){return e==t},n.matchFtn=r,n.layerName=t,Stdlib.traverseLayers(e,n,!1,!0),n.layer},Stdlib.findLayerByProperty=function(e,t,n,r){function i(e,t){return i.matchFtn(t[i.property],i.value)?i.all?(i.result.push(t),!0):(i.result=t,!1):!0}var s;return n instanceof RegExp?s=function(e,t){return e.match(t)!=null}:s=function(e,t){return e==t},i.matchFtn=s,i.property=t,i.value=n,i.all=r,r&&(i.result=[]),Stdlib.traverseLayers(e,i,!1,!0),i.result},Stdlib.isLayerEmpty=function(e,t){return e||(e=app.activeDocument),t||(t=e.activeLayer),t.bounds.toString().replace(/\D|0/g,"")==""},Stdlib.mergeVisible=function(e){Stdlib.doEvent(e,"MrgV")},Stdlib.mergeLayers=function(e,t){t&&Stdlib.selectLayers(e,t),Stdlib.doEvent(e,"Mrg2")},Stdlib.previousLayer=function(e){function t(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Bckw")),e.putReference(cTID("null"),t),e.putBoolean(cTID("MkVs"),!1),executeAction(cTID("slct"),e,DialogModes.NO)}var n=e.activeLayer;try{var r=$.level;$.level=0;var i=Stdlib.getActiveLayerIndex(e);Stdlib.wrapLC(e,t);var s=Stdlib.getActiveLayerIndex(e);s>i?n=e.activeLayer:(e.activeLayer=n,n=undefined)}catch(o){}finally{$.level=r,delete r}return n},Stdlib.nextLayer=function(e){function t(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Frwr")),e.putReference(cTID("null"),t),e.putBoolean(cTID("MkVs"),!1),executeAction(cTID("slct"),e,DialogModes.NO)}var n=e.activeLayer;try{var r=$.level;$.level=0;var i=Stdlib.getActiveLayerIndex(e);Stdlib.wrapLC(e,t);var s=Stdlib.getActiveLayerIndex(e);s>i?n=e.activeLayer:(e.activeLayer=n,n=undefined)}catch(o){}finally{$.level=r,delete r}return n},Stdlib.copyStyles=function(e,t){if(t==1){var n=$.level;$.level=0;var r=!1;try{Stdlib.doEvent(e,"CpFX"),r=!0}catch(i){}return $.level=n,r}return typeof t=="object"?(Stdlib.copyEffects(e,t),!0):(Stdlib.doEvent(e,"CpFX"),!0)},Stdlib.pasteStyles=function(e,t,n){if(n==1){var r=$.level;$.level=0;var i=!1;try{Stdlib.pasteStyles(e,t,!1),i=!0}catch(s){}return $.level=r,i}var o;t&&(o=Stdlib.makeActive(t)),Stdlib.doEvent(e,"PaFX"),o&&Stdlib.makeActive(o)},Stdlib.hasEffects=function(e,t){var n=!0,r=$.level;try{$.level=0,Stdlib.copyEffects(e,t)}catch(i){n=!1}finally{$.level=r}return n},Stdlib.hasLayerStyles=Stdlib.hasEffects,Stdlib.clearEffects=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),executeAction(sTID("disableLayerStyle"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,n)},Stdlib.clearLayerStyles=Stdlib.clearEffects,Stdlib.copyEffects=function(e,t){var n;t&&(n=Stdlib.makeActive(t)),Stdlib.doEvent(e,"CpFX"),n&&Stdlib.makeActive(n)},Stdlib.pasteEffects=function(e,t){var n;t&&(n=Stdlib.makeActive(t)),Stdlib.doEvent(e,"PaFX"),n&&Stdlib.makeActive(n)},Stdlib._setEffectsViz=function(e,t,n){function r(){var e=new ActionDescriptor,t=new ActionList,r=new ActionReference;r.putClass(cTID("Lefx")),r.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),t.putReference(r),e.putList(cTID("null"),t),executeAction(cTID(n),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,r)},Stdlib.hideLayerEffects=function(e,t){Stdlib._setEffectsViz(e,t,"Hd  ")},Stdlib.hideLayerStyles=Stdlib.hideEffects=Stdlib.hideLayerEffects,Stdlib.showLayerEffects=function(e,t){Stdlib._setEffectsViz(e,t,"Shw ")},Stdlib.showLayerStyles=Stdlib.showEffects=Stdlib.showLayerEffects,Stdlib.layerEffectsVisible=function(e,t){var n=e.activeLayer;n!=t&&(e.activeLayer=t);var r=Stdlib.getLayerDescriptor(e,t),i=cTID("lfxv"),s=r.hasKey(i)&&r.getBoolean(i);return n!=t&&(e.activeLayer=n),s},Stdlib.applyLayerStyleInteractive=function(e,t,n){return Stdlib.applyLayerStyle(e,t,n,!0)},Stdlib.applyLayerStyle=function(e,t,n,r){function i(){var e=new ActionDescriptor,t=new ActionReference;t.putProperty(cTID("Prpr"),cTID("Lefx")),t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),n||(n=new ActionDescriptor),e.putObject(cTID("T   "),cTID("Lefx"),n);var i=undefined,s=r?DialogModes.ALL:DialogModes.NO;try{i=executeAction(cTID("setd"),e,s)}catch(o){if(o.number!=8007)throw o}return i}return Stdlib.wrapLCLayer(e,t,i)},Stdlib.makeDocFromLayer=function(e,t,n){function r(){var e=new ActionDescriptor,r=new ActionReference;r.putClass(cTID("Dcmn")),e.putReference(cTID("null"),r),e.putString(cTID("Nm  "),n);var i=new ActionReference;i.putName(cTID("Lyr "),t.name),e.putReference(cTID("Usng"),i),executeAction(cTID("Mk  "),e,DialogModes.NO)}return e?app.activeDocument=e:e=app.activeDocument,t?e.activeLayer=t:t=e.activeLayer,r(),app.activeDocument},Stdlib.getDocumentFromLayer=function(e){while(e.parent!=undefined&&e.parent.typename!="Document")e=e.parent;return e.parent},Stdlib.hasLayerMask=function(e,t){function n(){var e=new ActionReference;e.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt"));var t=executeActionGet(e);return t.hasKey(cTID("UsrM"))}return Stdlib.wrapLCLayer(e,t,n)},Stdlib.removeLayerMask=function(e,t,n){function r(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Chnl"),cTID("Chnl"),cTID("Msk ")),e.putReference(cTID("null"),t),n=n==1,e.putBoolean(cTID("Aply"),n),executeAction(cTID("Dlt "),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,r)},Stdlib.removeMask=Stdlib.removeLayerMask,Stdlib.applyLayerMask=function(e,t){function n(){var e=new ActionReference;e.putEnumerated(cTID("Chnl"),cTID("Ordn"),cTID("Trgt"));var t=new ActionDescriptor;t.putReference(cTID("null"),e),t.putBoolean(cTID("Aply"),!0),executeAction(cTID("Dlt "),t,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,n)},Stdlib.selectLayerMask=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Chnl"),cTID("Chnl"),cTID("Msk ")),e.putReference(cTID("null"),t),e.putBoolean(cTID("MkVs"),!1),executeAction(cTID("slct"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,n)},Stdlib.selectLayerMaskEdit=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Chnl"),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),e.putBoolean(cTID("MkVs"),!0),executeAction(cTID("slct"),e,DialogModes.NO)}Stdlib.selectLayerMask(e,t),Stdlib.wrapLCLayer(e,t,n)},Stdlib.selectFilterMask=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Chnl"),cTID("Chnl"),sTID("filterMask")),e.putReference(cTID("null"),t),e.putBoolean(cTID("MkVs"),!1),executeAction(cTID("slct"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,n)},Stdlib.selectFilterMaskEdit=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Chnl"),cTID("Chnl"),sTID("filterMask")),e.putReference(cTID("null"),t),e.putBoolean(cTID("MkVs"),!0),executeAction(cTID("slct"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,n)},Stdlib.createLayerMask=function(e,t,n){function r(){var e=new ActionDescriptor;e.putClass(cTID("Nw  "),cTID("Chnl"));var t=new ActionReference;t.putEnumerated(cTID("Chnl"),cTID("Chnl"),cTID("Msk ")),e.putReference(cTID("At  "),t),n==1?e.putEnumerated(cTID("Usng"),cTID("UsrM"),cTID("RvlS")):e.putEnumerated(cTID("Usng"),cTID("UsrM"),cTID("RvlA")),executeAction(cTID("Mk  "),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,r)},Stdlib.isLayerMaskEnabled=function(e,t){var n=Stdlib.getLayerDescriptor(e,t);return n.hasKey(cTID("UsrM"))&&n.getBoolean(cTID("UsrM"))},Stdlib.disableLayerMask=function(e,t){Stdlib.setLayerMaskEnabledState(e,t,!1)},Stdlib.enableLayerMask=function(e,t){Stdlib.setLayerMaskEnabledState(e,t,!0)},Stdlib.setLayerMaskEnabledState=function(e,t,n){function r(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t);var r=new ActionDescriptor;r.putBoolean(cTID("UsrM"),n),e.putObject(cTID("T   "),cTID("Lyr "),r),executeAction(cTID("setd"),e,DialogModes.NO)}n==undefined&&(n=!1),Stdlib.wrapLCLayer(e,t,r)},Stdlib.createClippingMask=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),executeAction(cTID("GrpL"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,n)},Stdlib.releaseClippingMask=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),executeAction(cTID("Ungr"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,n)},Stdlib.hasClippingMask=function(e,t){return Stdlib.getLayerProperty(t,"Grup")},Stdlib.isClippingMask=function(e,t){var n=!1;try{var r=Stdlib.getLayerIndex(e,t);Stdlib.selectLayerByIndex(e,r+1);var n=Stdlib.getLayerProperty(e.activeLayer,"Grup");e.activeLayer=t}catch(i){}return n},Stdlib.rotateLayer=function(e,t,n){function r(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),e.putUnitDouble(cTID("Angl"),cTID("#Ang"),n),executeAction(cTID("Rtte"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,r)},Stdlib.rotateLayerAround=function(e,t,n,r,i){function s(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),e.putEnumerated(cTID("FTcs"),cTID("QCSt"),cTID("Qcsi"));var s=new ActionDescriptor;s.putUnitDouble(cTID("Hrzn"),cTID("#Pxl"),r),s.putUnitDouble(cTID("Vrtc"),cTID("#Pxl"),i),e.putObject(cTID("Pstn"),cTID("Pnt "),s),e.putUnitDouble(cTID("Angl"),cTID("#Ang"),n),executeAction(cTID("Trnf"),e,DialogModes.NO)}n=Number(n),isNaN(n)&&Error.runtimeError(19,"angle"),Stdlib.wrapLCLayer(e,t,s)},Stdlib.moveLayerContent=function(e,t,n,r){function i(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t);var i=new ActionDescriptor;i.putUnitDouble(cTID("Hrzn"),cTID("#Pxl"),n),i.putUnitDouble(cTID("Vrtc"),cTID("#Pxl"),r),e.putObject(cTID("T   "),cTID("Ofst"),i),executeAction(cTID("move"),e,DialogModes.NO)}t?Stdlib.wrapLCLayer(e,t,i):Stdlib.wrapLC(e,i)},Stdlib.moveLayerContentByIndex=function(e,t,n,r){function i(){var e=new ActionDescriptor,i=new ActionReference;i.putIndex(cTID("Lyr "),t),e.putReference(cTID("null"),i);var s=new ActionDescriptor;s.putUnitDouble(cTID("Hrzn"),cTID("#Pxl"),n),s.putUnitDouble(cTID("Vrtc"),cTID("#Pxl"),r),e.putObject(cTID("T   "),cTID("Ofst"),s),executeAction(cTID("move"),e,DialogModes.NO)}Stdlib.wrapLC(e,i)},Stdlib.freeTransform=function(e,t){Stdlib.doMenuItem(cTID("FrTr"),!0)},Stdlib.transformScale=function(e,t,n){function r(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),e.putEnumerated(cTID("FTcs"),cTID("QCSt"),cTID("Qcsa")),n==1&&e.putBoolean(cTID("Lnkd"),!0);var r=$.level;$.level=0;try{executeAction(cTID("Trnf"),e,DialogModes.ALL)}catch(i){$.level=r;if(i.number!=8007)throw i}$.level=r}Stdlib.wrapLCLayer(e,t,r)},Stdlib.transformScaleEx=function(e,t,n){function r(){function t(e,t){var n=new ActionDescriptor,r=new ActionReference;r.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),n.putReference(cTID("null"),r),n.putEnumerated(cTID("FTcs"),cTID("QCSt"),cTID("Qcsa"));var i=new ActionDescriptor;return i.putUnitDouble(cTID("Hrzn"),cTID("#Pxl"),e),i.putUnitDouble(cTID("Vrtc"),cTID("#Pxl"),t),n.putObject(cTID("Ofst"),cTID("Ofst"),i),n}var e=!0;executeAction(cTID("Trnf"),t(1,1),DialogModes.NO);var n=t(-1,-1),r=$.level;$.level=0;try{executeAction(cTID("Trnf"),n,DialogModes.ALL)}catch(i){e=!1;if(i.number!=8007)throw i;executeAction(cTID("Trnf"),n,DialogModes.NO)}finally{$.level=r}return e}return Stdlib.wrapLCLayer(e,t,r)},Stdlib.getLayerBounds=function(e,t){var n=app.preferences.rulerUnits;try{app.preferences.rulerUnits=Units.PIXELS;var r=!1,i;Stdlib.hasLayerMask(e,t)&&Stdlib.isLayerMaskEnabled(e,t)&&(i=e.activeHistoryState,Stdlib.disableLayerMask(e,t),r=!0);var s=t.bounds;r&&Stdlib.enableLayerMask(e,t);for(var o=0;o<4;o++)s[o]=s[o].value}finally{app.preferences.rulerUnits=n}return s},Stdlib.transformLayer=function(e,t,n,r){function d(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),e.putEnumerated(cTID("FTcs"),cTID("QCSt"),cTID("Qcsa"));var n=new ActionDescriptor;n.putUnitDouble(cTID("Hrzn"),cTID("#Pxl"),f),n.putUnitDouble(cTID("Vrtc"),cTID("#Pxl"),l),e.putObject(cTID("Ofst"),cTID("Ofst"),n),e.putUnitDouble(cTID("Wdth"),cTID("#Prc"),h),e.putUnitDouble(cTID("Hght"),cTID("#Prc"),p),executeAction(cTID("Trnf"),e,DialogModes.NO)}var i=Stdlib.getLayerBounds(e,t),s=n[2]-n[0],o=n[3]-n[1],u=i[2]-i[0],a=i[3]-i[1],f=n[0]-(i[0]-(s-u)/2),l=n[1]-(i[1]-(o-a)/2),c,h,p;r||(r="both"),r.toLowerCase()=="horz"?p=h=s/u*100:r=="both"?(h=s/u*100,p=o/a*100):p=h=o/a*100,Stdlib.wrapLCLayer(e,t,d)},Stdlib.rasterizeLayer=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),executeAction(sTID("rasterizeLayer"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,n)},Stdlib.convertToLayer=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),e.putEnumerated(cTID("What"),sTID("rasterizeItem"),sTID("placed")),executeAction(sTID("rasterizeLayer"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,n)},Stdlib.placeImage=function(e,t,n){function r(){var e=new ActionDescriptor;e.putPath(cTID("null"),n),e.putEnumerated(cTID("FTcs"),cTID("QCSt"),cTID("Qcsa"));var t=new ActionDescriptor;t.putUnitDouble(cTID("Hrzn"),cTID("#Pxl"),0),t.putUnitDouble(cTID("Vrtc"),cTID("#Pxl"),0),e.putObject(cTID("Ofst"),cTID("Ofst"),t),executeAction(cTID("Plc "),e,DialogModes.NO)}return Stdlib.makeActive(e),Stdlib.makeActive(t),r(),e.activeLayer},Stdlib.deleteAllHiddenLayers=function(e){function t(){var e=new ActionReference;e.putEnumerated(cTID("Lyr "),cTID("Ordn"),sTID("hidden"));var t=new ActionDescriptor;t.putReference(cTID("null"),e),executeAction(cTID("Dlt "),t,DialogModes.NO)}Stdlib.wrapLC(e,t)},Stdlib.hideAllLayers=function(e){var t=Stdlib.getLayersList(e,!1,!0);for(var n=0;n<t.length;n++)t[n].visible=!1},Stdlib.showAllLayers=function(e){var t=Stdlib.getLayersList(e,!1,!0);for(var n=0;n<t.length;n++)t[n].visible=!0},Stdlib.hideSelectedLayers=function(e){function t(){var e=new ActionDescriptor,t=new ActionList,n=new ActionReference;n.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),t.putReference(n),e.putList(cTID("null"),t),executeAction(cTID("Hd  "),e,DialogModes.NO)}Stdlib.wrapLC(e,t)},Stdlib.showSelectedLayers=function(e){function t(){var e=new ActionDescriptor,t=new ActionList,n=new ActionReference;n.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),t.putReference(n),e.putList(cTID("null"),t),executeAction(cTID("Shw "),e,DialogModes.NO)}Stdlib.wrapLC(e,t)},Stdlib.newGroupFromLayers=function(e){function t(){var e=new ActionDescriptor,t=new ActionReference;t.putClass(sTID("layerSection")),e.putReference(cTID("null"),t);var n=new ActionReference;n.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("From"),n),executeAction(cTID("Mk  "),e,DialogModes.NO)}return Stdlib.wrapLC(e,t),e.activeLayer},Stdlib.ungroupLayers=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),executeAction(sTID("ungroupLayersEvent"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,n)},Stdlib.deleteGroup=function(e,t,n){function r(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),e.putBoolean(sTID("deleteContained"),!!n),executeAction(cTID("Dlt "),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,r)},Stdlib.getLayerNameByIndex=function(e,t){var n=new ActionReference;return n.putProperty(cTID("Prpr"),cTID("Nm  ")),n.putIndex(cTID("Lyr "),t),executeActionGet(n).getString(cTID("Nm  "))},Stdlib.setLayerName=function(e,t,n){var r=new ActionDescriptor,i=new ActionReference;i.putIndex(cTID("Lyr "),t),r.putReference(cTID("null"),i);var s=new ActionDescriptor;s.putString(cTID("Nm  "),n),r.putObject(cTID("T   "),cTID("Lyr "),s),executeAction(cTID("setd"),r,DialogModes.NO)},Stdlib.getActiveLayerIndex=function(e){return Stdlib.getLayerIndex(e,e.activeLayer)},Stdlib.getActiveLayerDescriptor=function(e){function t(){var e=new ActionReference;return e.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),executeActionGet(e)}return Stdlib.wrapLC(e,t)},Stdlib.getLayerIndex=function(e,t,n){var r=Stdlib.getLayerProperty(t,"ItmI");return Stdlib.hasBackground(e)?r-1:r},Stdlib.getLayerID=function(e,t){var n=Stdlib.getLayerDescriptor(e,t);return n.getInteger(cTID("LyrI"))},Stdlib.getLayerType=function(e,t){var n=Stdlib.getLayerIndex(e,t);return Stdlib.getLayerTypeByIndex(e,n)},Stdlib.getLayerTypeByIndex=function(e,t){var n=new ActionReference;return n.putProperty(cTID("Prpr"),sTID("layerSection")),n.putIndex(cTID("Lyr "),t),executeActionGet(n).getEnumerationValue(sTID("layerSection"))},Stdlib.isLayerSelected=function(e,t){var n=Stdlib.getSelectedLayers(e,!0);return n.contains(t)},Stdlib.deleteSelectedLayers=function(e){function t(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),executeAction(cTID("Dlt "),e,DialogModes.NO)}Stdlib.wrapLC(e,t)},Stdlib.selectLayer=function(e,t,n){isCS()?e.activeLayer=t:Stdlib.selectLayerByIndex(e,Stdlib.getLayerIndex(e,t,!0),n)},Stdlib.selectLayers=function(e,t,n){var r=[],i=[],s=e.activeLayer.visible;for(var o=0;o<t.length;o++){var u=t[o];i[o]=u.visible,r.push(Stdlib.getLayerIndex(e,u))}Stdlib.selectLayersByIndex(e,r,n);for(var o=0;o<t.length;o++)t[o].visible=i[o];e.activeLayer.visible=s},Stdlib.selectLayerByName=Stdlib.selectLayer,Stdlib.selectLayerByIndex=function(e,t,n){if(n){var r=new ActionDescriptor,i=new ActionReference;i.putIndex(cTID("Lyr "),t),r.putReference(cTID("null"),i),r.putEnumerated(sTID("selectionModifier"),sTID("selectionModifierType"),sTID("addToSelection")),r.putBoolean(cTID("MkVs"),!1),executeAction(cTID("slct"),r,DialogModes.NO)}else{var i=new ActionReference;i.putIndex(cTID("Lyr "),t);var r=new ActionDescriptor;r.putReference(cTID("null"),i),executeAction(cTID("slct"),r,DialogModes.NO)}},Stdlib.selectLayersByIndex=function(e,t,n){if(!t||t.length==0)return;t=t.slice(0),n!=1&&Stdlib.selectLayerByIndex(e,t.pop());while(t.length)Stdlib.selectLayerByIndex(e,t.pop(),!0)},Stdlib.deselectLayer=function(e,t){if(isCS())return;Stdlib.deselectLayerByIndex(e,Stdlib.getLayerIndex(e,t,!0))},Stdlib.deselectAllLayers=function(e){function t(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),executeAction(sTID("selectNoLayers"),e,DialogModes.NO)}Stdlib.wrapLC(e,t)},Stdlib.selectAllLayers=function(e){function t(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),executeAction(sTID("selectAllLayers"),e,DialogModes.NO)}Stdlib.wrapLC(e,t)},Stdlib.deselectLayers=function(e,t){if(isCS())return;var n=[],r=[];for(var i=0;i<t.length;i++){var s=t[i];r[i]=s.visible,n.push(Stdlib.getLayerIndex(e,s))}Stdlib.deselectLayersByIndex(e,n)},Stdlib.deselectLayerByIndex=function(e,t){if(isCS())return;var n=new ActionDescriptor,r=new ActionReference;r.putIndex(cTID("Lyr "),t),n.putReference(cTID("null"),r),n.putEnumerated(sTID("selectionModifier"),sTID("selectionModifierType"),sTID("removeFromSelection")),n.putBoolean(cTID("MkVs"),!1),executeAction(cTID("slct"),n,DialogModes.NO)},Stdlib.deselectLayersByIndex=function(e,t){if(isCS())return;if(!t||t.length==0)return;t=t.slice(0);while(t.length)Stdlib.deselectLayerByIndex(e,t.pop())},Stdlib.deselectLayerByName=function(e,t){var n=new ActionDescriptor,r=new ActionReference;r.putName(cTID("Lyr "),t),n.putReference(cTID("null"),r),n.putEnumerated(sTID("selectionModifier"),sTID("selectionModifierType"),sTID("removeFromSelection")),n.putBoolean(cTID("MkVs"),!1),executeAction(cTID("slct"),n,DialogModes.NO)},Stdlib.getLayerBoundsByIndex=function(e,t){var n=Stdlib.getLayerDescriptorByIndex(e,t),r=n.getObjectValue(sTID("bounds")),i=[];return i.push(r.getUnitDoubleValue(cTID("Left"))),i.push(r.getUnitDoubleValue(cTID("Top "))),i.push(r.getUnitDoubleValue(cTID("Rght"))),i.push(r.getUnitDoubleValue(cTID("Btom"))),i},Stdlib.getLayerOpacityByIndex=function(e,t){var n=Stdlib.getLayerDescriptorByIndex(e,t);return n.getInteger(cTID("Opct"))},Stdlib.selectLayerByIdentifier=function(e,t){var n=new ActionReference;n.putIdentifier(cTID("Lyr "),t);var r=new ActionDescriptor;r.putReference(cTID("null"),n),executeAction(cTID("slct"),r,DialogModes.NO)},Stdlib.hasBG=function(e){try{var t=new ActionReference;return t.putIndex(cTID("Lyr "),0),executeActionGet(t),!0}catch(n){return!1}},Stdlib.getLayerDescriptorByIndex=function(e,t){var n=new ActionReference;return n.putIndex(cTID("Lyr "),t),executeActionGet(n)},Stdlib.getLayerDescriptor=function(e,t,n){function r(){var e=new ActionReference;return e.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),executeActionGet(e)}return n?(Stdlib.makeActive(e),Stdlib.makeActive(t),r()):Stdlib.wrapLCLayer(e,t,r)},Stdlib.getVectorMaskDescriptor=function(e,t){function n(){var e=new ActionReference;e.putEnumerated(cTID("Path"),cTID("Ordn"),sTID("vectorMask"));try{return app.executeActionGet(e)}catch(t){return undefined}}return Stdlib.wrapLCLayer(e,t,n)},Stdlib.getPathDescriptor=function(e,t,n){var r=e.pathItems.length,i=0,s;if(n=="WorkPath"){var o=new ActionReference;o.putProperty(cTID("Path"),cTID("WrPt")),s=app.executeActionGet(o)}else for(var u=1;u<=r;u++)try{var o=new ActionReference;o.putIndex(cTID("Path"),u);var a=app.executeActionGet(o),f=a.getString(cTID("PthN"));if(f==n){s=a;break}}catch(l){break}return s},Stdlib.getLayerStyleDescriptor=function(e,t){function n(){var e=new ActionReference;e.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt"));var t=executeActionGet(e);return t.getObjectValue(sTID("layerEffects"))}return Stdlib.wrapLCLayer(e,t,n)},Stdlib.loadSelection=function(e,t,n,r){function i(){var e=new ActionDescriptor,t=new ActionReference;t.putProperty(cTID("Chnl"),cTID("fsel")),e.putReference(cTID("null"),t);var i=new ActionReference;i.putEnumerated(cTID("Chnl"),cTID("Chnl"),cTID(n)),e.putReference(cTID("T   "),i),r==1&&e.putBoolean(cTID("Invr"),!0),executeAction(cTID("setd"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,i)},Stdlib.selectTransparencyChannel=function(e,t,n){Stdlib.loadSelection(e,t,"Trsp",n)},Stdlib.selectMaskChannel=function(e,t,n){Stdlib.loadSelection(e,t,"Msk ",n)},Stdlib.saveNamedSelection=function(e,t,n){function r(){var e=new ActionDescriptor,t=new ActionReference;t.putProperty(cTID("Chnl"),cTID("fsel")),e.putReference(cTID("null"),t),e.putString(cTID("Nm  "),n),executeAction(cTID("Dplc"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,r)},Stdlib.selectNamedSelection=function(e,t,n){function r(){var e=new ActionDescriptor,t=new ActionReference;t.putName(cTID("Chnl"),n),e.putReference(cTID("null"),t),executeAction(cTID("slct"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,r)},Stdlib.loadNamedSelection=function(e,t,n,r){function i(){var e=new ActionDescriptor,t=new ActionReference;t.putProperty(cTID("Chnl"),cTID("fsel")),e.putReference(cTID("null"),t);var i=new ActionReference;i.putName(cTID("Chnl"),n),e.putReference(cTID("T   "),i),r==1&&e.putBoolean(cTID("Invr"),!0),executeAction(cTID("setd"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,i)},Stdlib.deleteNamedSelection=function(e,t,n){function r(){Stdlib.selectNamedSelection(e,t,n);var r=new ActionDescriptor,i=new ActionReference;i.putEnumerated(cTID("Chnl"),cTID("Ordn"),cTID("Trgt")),r.putReference(cTID("null"),i),executeAction(cTID("Dlt "),r,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,r)},Stdlib.getMaskBounds=function(e,t){function n(){var n=e.activeHistoryState;Stdlib.selectMaskChannel(e,t);var r=Stdlib.getSelectionBounds(e);return e.activeHistoryState=n,r}var r=Stdlib.wrapLCLayer(e,t,n);return r},Stdlib.appendMaskToSelection=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Chnl"),cTID("Chnl"),cTID("Msk ")),e.putReference(cTID("null"),t);var n=new ActionReference;n.putProperty(cTID("Chnl"),cTID("fsel")),e.putReference(cTID("T   "),n),executeAction(cTID("Add "),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,n)},Stdlib.appendTransparencyToSelection=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Chnl"),cTID("Chnl"),cTID("Trsp")),e.putReference(cTID("null"),t);var n=new ActionReference;n.putProperty(cTID("Chnl"),cTID("fsel")),e.putReference(cTID("T   "),n),executeAction(cTID("Add "),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,n)},Stdlib.isLayerMaskLinked=function(e,t){var n=Stdlib.getLayerDescriptor(e,t);return n.hasKey(cTID("Usrs"))&&n.getBoolean(cTID("Usrs"))},Stdlib._linkMask=function(e,t,n){function r(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t);var r=new ActionDescriptor;r.putBoolean(cTID("Usrs"),n),e.putObject(cTID("T   "),cTID("Lyr "),r),executeAction(cTID("setd"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,r)},Stdlib.unlinkLayerMask=function(e,t){Stdlib._linkMask(e,t,!1)},Stdlib.unlinkMask=Stdlib.unlinkLayerMask,Stdlib.linkLayerMask=function(e,t){Stdlib._linkMask(e,t,!0)},Stdlib.linkMask=Stdlib.linkLayerMask,Stdlib.unlinkSelectedLayers=function(e){var t=new ActionDescriptor,n=new ActionReference;n.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),t.putReference(cTID("null"),n),executeAction(sTID("unlinkSelectedLayers"),t,DialogModes.NO)},Stdlib.unlinkLayers=function(e,t){for(var n=0;n<t.length;n++){var r=t[n],i=r.visibile;r.unlink(),r.visibile=i}},Stdlib.linkSelectedLayers=function(e){var t=new ActionDescriptor,n=new ActionReference;n.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),t.putReference(cTID("null"),n),executeAction(sTID("linkSelectedLayers"),t,DialogModes.NO)},Stdlib.linkLayers=function(e,t){var n=t[0];n.unlink();for(var r=1;r<t.length;r++){var i=t[r],s=i.visible;i.unlink(),i.link(n),i.visible=s}},Stdlib.selectLinkedLayers=function(e){function t(){var e=new ActionReference;e.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt"));var t=new ActionDescriptor;executeAction(sTID("selectLinkedLayers"),t,DialogModes.NO)}Stdlib.wrapLC(e,t)},Stdlib.getLinkedLayers=function(e,t){var n;n=t.linkedLayers.slice(0);if(n.length>0){n.unshift(t);var r=[],i=Stdlib.getLayersList(e);for(var s=0;s<i.length;s++){var o=i[s];n.contains(o)&&r.push(o)}n=r}else n=[t];return n},Stdlib.getSelectedLayers=function(e,t){var n=Stdlib.getLayersList(e,undefined,t),r=[],i=[];if(isCS()||isPS7())return[e.activeLayer];if(e.layers.length==1&&Stdlib.hasBackgroundLayer(e))return[e.backgroundLayer];if(isCS2()||!0){for(var s=0;s<n.length;s++){var o=n[s];r[s]=o.visible}for(var s=0;s<n.length;s++){var o=n[s];o.visible=!1}Stdlib.showSelectedLayers(e);for(var s=0;s<n.length;s++){var o=n[s];o.visible&&i.push(o),o.visible=r[s]}return i}var i=[];Stdlib.newGroupFromLayers(e);var u=e.activeLayer,n=u.layers;for(var s=0;s<n;s++)i.push(n[s]);return Stdlib.Undo(),i},Stdlib.insertImageIntoMask=function(e,t,n,r){Stdlib.hasLayerMask(e,t)||Error.runtimeError(9001,"A Layer mask is required for this operation."),Stdlib.selectMaskChannel(e,t);var i=Stdlib.insertImageIntoSelection(e,t,n,r);return Stdlib.linkLayerMask(e,i),e.selection.deselect(),i},Stdlib.insertImageIntoSelection=function(e,t,n,r){var i,s;n instanceof Document?i=n:s=Stdlib.convertFptr(n),r==undefined&&(r=!0),Stdlib.hasSelection(e)||Error.runtimeError(8152);if(!i){if(!s.exists)return alert("Image "+s+" does not exist."),undefined;i=app.open(s)}else app.activeDocument=i,i=i.duplicate();app.activeDocument=e;var o=app.preferences.rulerUnits;try{app.preferences.rulerUnits=Units.PIXELS;var u=t.name,a=Stdlib.getSelectionBounds(e),f=a[2]-a[0],l=a[3]-a[1];if(r)app.activeDocument=i,i.resizeImage(undefined,undefined,e.resolution,ResampleMethod.NONE),Stdlib.fitImage(i,f,l);else{var c=i.width.value,h=i.height.value,p=l/f,d=h/c;d>p?l=undefined:f=undefined,app.activeDocument=i,i.resizeImage(f,l,e.resolution,ResampleMethod.BICUBIC)}i.selection.selectAll(),i.layers.length>1?i.selection.copy(!0):i.selection.copy(),app.activeDocument=e,e.activeLayer=t;var v=Stdlib.hasLayerStyles(e,t);v&&Stdlib.copyStyles(e),Stdlib.hasSelection(e)||Stdlib.selectBounds(e,a),Stdlib.pasteInto(e),t.remove(),e.activeLayer.name=u,v&&Stdlib.pasteStyles(e)}catch(m){t=undefined,alert(Stdlib.exceptionMessage(m))}finally{app.preferences.rulerUnits=o;try{i.close(SaveOptions.DONOTSAVECHANGES)}catch(m){}}return e.activeLayer},Stdlib.insertImageIntoSelectionAsSmartObject=function(e,t,n,r){app.activeDocument=e,e.activeLayer=t;var i=Stdlib.convertFptr(n);r==undefined&&(r=!0),Stdlib.hasSelection(e)||Error.runtimeError(8152),i.exists||Error.runtimeError(48);var s=app.preferences.rulerUnits,o=e.resolution;try{o!=72&&e.resizeImage(undefined,undefined,72,ResampleMethod.NONE),app.preferences.rulerUnits=Units.PIXELS;var u=Stdlib.hasLayerStyles(e,t);u&&Stdlib.copyStyles(e,t);var a=t.name,f=Stdlib.getSelectionBounds(e),l;l=Stdlib.placeImage(e,t,i),l.resize(100,100,AnchorPosition.MIDDLECENTER);var c=f[2]-f[0],h=f[3]-f[1],p=Stdlib.getLayerBounds(e,l),d=p[2]-p[0],v=p[3]-p[1],m=h/c,g=v/d,y;!r||r!=1&&r.toString().toLowerCase()!="fit"?y=g>m?"horz":"vert":y=g>m?"vert":"horz",Stdlib.transformLayer(e,l,f,y),l.name=a,t.remove(),u&&Stdlib.pasteStyles(e)}catch(b){alert(Stdlib.exceptionMessage(b))}finally{app.preferences.rulerUnits=s,o!=72&&e.resizeImage(undefined,undefined,o,ResampleMethod.NONE)}return l},Stdlib.resizeCanvas=function(e,t,n,r,i){var s=r.hsb,o=new ActionDescriptor;toBoolean(i)&&o.putBoolean(cTID("Rltv"),toBoolean(i)),o.putUnitDouble(cTID("Wdth"),cTID("#Pxl"),t),o.putUnitDouble(cTID("Hght"),cTID("#Pxl"),n),o.putEnumerated(cTID("Hrzn"),cTID("HrzL"),cTID("Cntr")),o.putEnumerated(cTID("Vrtc"),cTID("VrtL"),cTID("Cntr"));if(r){o.putEnumerated(sTID("canvasExtensionColorType"),sTID("canvasExtensionColorType"),cTID("Clr "));var u=new ActionDescriptor;u.putUnitDouble(cTID("H   "),cTID("#Ang"),s.hue),u.putDouble(cTID("Strt"),s.saturation),u.putDouble(cTID("Brgh"),s.brightness),o.putObject(sTID("canvasExtensionColor"),cTID("HSBC"),u)}executeAction(cTID("CnvS"),o,DialogModes.NO)},_ResizeOptions=function(){var e=this;e.width=1024,e.weight=1024,e.constrain=!0,e.scaleStyles=!0,e.resample=!0,e.resampleMethod=ResampleMethod.BICUBIC},Stdlib._resizeImage=function(e,t){function n(){var e=new ActionDescriptor;e.putUnitDouble(cTID("Wdth"),cTID("#Pxl"),t.width),e.putBoolean(sTID("scaleStyles"),t.scaleStyles),e.putBoolean(cTID("CnsP"),!0),e.putEnumerated(cTID("Intr"),cTID("Intp"),cTID("Bcbc")),executeAction(cTID("ImgS"),e,DialogModes.NO);var n=charIDToTypeID("ImgS"),r=new ActionDescriptor,i=charIDToTypeID("Wdth"),s=charIDToTypeID("#Rlt");r.putUnitDouble(i,s,477.217685),executeAction(n,r,DialogModes.NO);var o=new ActionDescriptor;o.putUnitDouble(cTID("Wdth"),cTID("#Pxl"),1024),o.putUnitDouble(cTID("Hght"),cTID("#Rlt"),468.936026),o.putEnumerated(cTID("Intr"),cTID("Intp"),cTID("Bcbc")),executeAction(cTID("ImgS"),o,DialogModes.NO)}Stdlib.wrapLC(e,n)},Stdlib.PSfitImage=function(e,t){var n=new ActionDescriptor;n.putUnitDouble(cTID("Wdth"),cTID("#Pxl"),e),n.putUnitDouble(cTID("Hght"),cTID("#Pxl"),t);var r=sTID("3caa3434-cb67-11d1-bc43-0060b0a13dc4");return executeAction(r,n,DialogModes.NO)},Stdlib.fitImage=function(e,t,n,r){Stdlib.resizeImage(e,t,n,!0,r)},Stdlib.resizeImage=function(e,t,n,r,i){function s(){r==undefined&&(r=!0),i==undefined&&(i=ResampleMethod.BICUBIC);var s=e.width.value,o=e.height.value,u=e.resolution;if(s==t&&o==n)return;e.resizeImage(undefined,undefined,72,ResampleMethod.NONE);if(r){var a=o/s,f=n/t;a>f?t=undefined:n=undefined}e.resizeImage(t,n,72,i),e.resizeImage(undefined,undefined,u,ResampleMethod.NONE)}var o=app.preferences.rulerUnits;app.preferences.rulerUnits=Units.PIXELS,Stdlib.wrapLC(e,s),app.preferences.rulerUnits=o},Stdlib.crop=function(e){Stdlib.doEvent(e,"Crop")},Stdlib.cropBounds=function(e,t){Stdlib.selectBounds(e,t),Stdlib.crop(e),e.selection.deselect()},Stdlib.interactiveCrop=function(e,t){var n=new ActionDescriptor,r=new ActionDescriptor;r.putUnitDouble(cTID("Top "),cTID("#Pxl"),t[0]),r.putUnitDouble(cTID("Left"),cTID("#Pxl"),t[1]),r.putUnitDouble(cTID("Btom"),cTID("#Pxl"),t[2]),r.putUnitDouble(cTID("Rght"),cTID("#Pxl"),t[3]),n.putObject(cTID("T   "),cTID("Rctn"),r),n.putUnitDouble(cTID("Angl"),cTID("Ang "),0),n.putUnitDouble(cTID("Wdth"),cTID("#Pxl"),0),n.putUnitDouble(cTID("Hght"),cTID("#Pxl"),0),n.putUnitDouble(cTID("Rslt"),cTID("#Rsl"),0);try{executeAction(cTID("Crop"),n,DialogModes.ALL)}catch(i){if(i.number!=8007)throw i;return!1}return!0},Stdlib.transformSelection=function(e){var t=new ActionDescriptor,n=new ActionReference;n.putProperty(cTID("Chnl"),cTID("fsel")),t.putReference(cTID("null"),n),executeAction(cTID("Trnf"),t,DialogModes.ALL)},Stdlib.freeTransformSelection=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Mn  "),cTID("MnIt"),cTID("FrTr")),e.putReference(cTID("null"),t),app.executeAction(cTID("slct"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,n)},Stdlib.magicWand=function(e,t,n,r,i,s){function o(){var e=new ActionDescriptor,o=new ActionReference;o.putProperty(cTID("Chnl"),cTID("fsel")),e.putReference(cTID("null"),o);var u=new ActionDescriptor;u.putUnitDouble(cTID("Hrzn"),cTID("#Pxl"),t),u.putUnitDouble(cTID("Vrtc"),cTID("#Pxl"),n),e.putObject(cTID("T   "),cTID("Pnt "),u),r!=undefined&&e.putInteger(cTID("Tlrn"),r),e.putBoolean(cTID("AntA"),!!i),e.putBoolean(cTID("Cntg"),!!s),executeAction(cTID("setd"),e,DialogModes.NO)}Stdlib.wrapLC(e,o)},Stdlib.selectSimilar=function(e,t,n){function r(){var e=new ActionDescriptor,r=new ActionReference;r.putProperty(cTID("Chnl"),cTID("fsel")),e.putReference(cTID("null"),r),t!=undefined&&e.putInteger(cTID("Tlrn"),t),e.putBoolean(cTID("AntA"),n!=0),executeAction(cTID("Smlr"),e,DialogModes.NO)}Stdlib.wrapLC(e,r)},Stdlib.selectBounds=function(e,t,n,r,i){function s(){e.selection.select([[t[0],t[1]],[t[2],t[1]],[t[2],t[3]],[t[0],t[3]]],n,r,i)}r==undefined&&(r=0),i==undefined&&(i=!1),Stdlib.wrapLC(e,s)},Stdlib.computeSelectionBoundsLS=function(e){var t=[],n=app.preferences.rulerUnits;app.preferences.rulerUnits=Units.PIXELS;var r=e.activeLayer;try{var i=e.layerSets.add(),s=i.artLayers.add();e.activeLayer=s,e.selection.fill(app.foregroundColor),t=i.bounds,i.remove()}finally{e.activeLayer=r,app.preferences.rulerUnits=n}return t},Stdlib.computeSelectionBounds=function(e){var t=[],n=$.level;try{$.level=0,e.selection.makeWorkPath()}catch(r){return $.level=n,t}$.level=n;try{var i=e.pathItems;if(i.length>0)for(var s=0;s<i.length;s++){var o=i[s].subPathItems;for(var u=0;u<o.length;u++){var a=o[u].pathPoints;for(var f=0;f<a.length;f++){var l=a[f].anchor;t.length==0?(t[0]=t[2]=l[0],t[1]=t[3]=l[1]):(l[0]<t[0]?t[0]=l[0]:l[0]>t[2]&&(t[2]=l[0]),l[1]<t[1]?t[1]=l[1]:l[1]>t[3]&&(t[3]=l[1]))}}}}finally{Stdlib.undo()}return t},Stdlib.computeSelectionBoundsPS7=function(e){var t=[];Stdlib.makeWorkPath(e);try{var n=Stdlib.getPathItems(e);for(var r=0;r<n.count;r++){var i=n.getObjectValue(r).getList(sTID("subpathListKey")),s=i.getObjectValue(0).getList(sTID("points"));for(var o=0;o<s.count;o++){var u=s.getObjectValue(o).getObjectValue(sTID("anchor")),a=[u.getUnitDoubleValue(sTID("horizontal")),u.getUnitDoubleValue(sTID("vertical"))];t.length==0?(t[0]=t[2]=a[0],t[1]=t[3]=a[1]):(a[0]<t[0]?t[0]=a[0]:a[0]>t[2]&&(t[2]=a[0]),a[1]<t[1]?t[1]=a[1]:a[1]>t[3]&&(t[3]=a[1]))}}}finally{Stdlib.undo()}return t},Stdlib.getSelectionBounds=function(e){function t(){if(!isCS()&&!isCS2()){var t=e.selection.bounds;for(var n=0;n<t.length;n++)t[n]=t[n].value;return t}var r=e.artLayers.add();e.selection.fill(app.foregroundColor);var t=r.bounds,i=e.historyStates;i[i.length-2].name=="Layer Order"?e.activeHistoryState=i[i.length-4]:e.activeHistoryState=i[i.length-3];for(var n=0;n<t.length;n++)t[n]=t[n].value;return t}return Stdlib.wrapLCLayer(e,e.activeLayer,t)},Stdlib.selectBackground=function(e,t){Stdlib.hideAllLayers(e),t.visible=!0,Stdlib.magicWand(e,0,0),Stdlib.selectSimilar(e),e.selection.invert()},Stdlib.hasSelection=function(e){var t=!1;if(!isCS()&&!isCS2()){var n=$.level;$.level=0;try{activeDocument.selection.bounds,t=!0}catch(r){}$.level=n}else{var i=e.activeHistoryState;e.selection.deselect(),i!=e.activeHistoryState&&(t=!0,e.activeHistoryState=i)}return t},Stdlib.computeSelectionRegion=function(e){var t=[],n=$.level;try{$.level=0,e.selection.makeWorkPath()}catch(r){return $.level=n,t}$.level=n;try{var i=e.pathItems["Work Path"],s=i.subPathItems;for(var o=0;o<s.length;o++){var u=s[o],a=u.pathPoints;for(var f=0;f<a.length;f++){var l=a[f];t.push(l.anchor)}}}finally{Stdlib.undo()}return t},Stdlib.centerCanvasOnSelection=function(e){Stdlib.hasSelection(e)||Error.runtimeError(8152);var t=app.preferences.rulerUnits;try{app.preferences.rulerUnits=Units.PIXELS;var n=Stdlib.getSelectionBounds(e),r=(n[0]+n[2])/2,i=(n[1]+n[3])/2,s=e.width.value/2,o=e.height.value/2;e.activeLayer.translate(s-r,o-i),e.selection.translateBoundary(s-r,o-i)}finally{app.preferences.rulerUnits=t}},Stdlib.centerLayer=function(e,t){var n=app.preferences.rulerUnits;app.preferences.rulerUnits=Units.PIXELS;try{var r=Stdlib.getLayerBounds(e,t),i=r[2]-r[0],s=r[3]-r[1],o=e.width.value,u=e.height.value,a=o/2-i/2,f=u/2-s/2,l=a-r[0],c=f-r[1];t.translate(l,c)}finally{app.preferences.rulerUnits=n}},Stdlib._doVectorMask=function(e,t,n,r){function i(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t);var i=new ActionDescriptor;i.putBoolean(xTID(n),r),e.putObject(cTID("T   "),cTID("Lyr "),i),executeAction(cTID("setd"),e,DialogModes.NO)}return Stdlib.wrapLCLayer(e,t,i)},Stdlib.disableVectorMask=function(e,t){Stdlib._doVectorMask(e,t,"vectorMaskEnabled",!1)},Stdlib.enableVectorMask=function(e,t){Stdlib._doVectorMask(e,t,"vectorMaskEnabled",!0)},Stdlib.unlinkVectorMask=function(e,t){Stdlib._doVectorMask(e,t,"vectorMaskLinked",!1)},Stdlib.linkVectorMask=function(e,t){Stdlib._doVectorMask(e,t,"vectorMaskLinked",!0)},Stdlib.removeVectorMask=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Path"),cTID("Path"),sTID("vectorMask")),t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),executeAction(cTID("Dlt "),e,DialogModes.NO)}return Stdlib.wrapLCLayer(e,t,n)},Stdlib.hasVectorMask=function(e,t){return Stdlib.getVectorMaskDescriptor(e,t)!=undefined},Stdlib.isVectorMaskEnabled=function(e,t){var n=!1;if(Stdlib.hasVectorMask(e,t))try{var r=e.activeHistoryState;Stdlib.enableVectorMask(e,t),e.activeHistoryState==r?n=!0:e.activeHistoryState=r}catch(i){}return n},Stdlib.rasterizeVectorMask=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),e.putEnumerated(cTID("What"),sTID("rasterizeItem"),sTID("vectorMask")),executeAction(sTID("rasterizeLayer"),e,DialogModes.NO)}return Stdlib.wrapLCLayer(e,t,n)},Stdlib.selectVectorMask=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;return t.putEnumerated(cTID("Path"),cTID("Path"),sTID("vectorMask")),t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),executeAction(cTID("slct"),e,DialogModes.NO)}return Stdlib.wrapLCLayer(e,t,n)},Stdlib.deselectVectorMask=Stdlib.deselectActivePath,Stdlib.loadVectorMaskSelection=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putProperty(cTID("Chnl"),cTID("fsel")),e.putReference(cTID("null"),t);var n=new ActionReference;n.putEnumerated(cTID("Path"),cTID("Path"),sTID("vectorMask")),n.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("T   "),n),e.putBoolean(cTID("AntA"),!0),e.putUnitDouble(cTID("Fthr"),cTID("#Pxl"),0),executeAction(cTID("setd"),e,DialogModes.NO)}return Stdlib.wrapLCLayer(e,t,n)},Stdlib.rotateVectorMask=function(e,t,n){function r(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Path"),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t),e.putEnumerated(cTID("FTcs"),cTID("QCSt"),cTID("Qcsa"));var r=new ActionDescriptor;r.putUnitDouble(cTID("Hrzn"),cTID("#Pxl"),0),r.putUnitDouble(cTID("Vrtc"),cTID("#Pxl"),0),e.putObject(cTID("Ofst"),cTID("Ofst"),r),e.putUnitDouble(cTID("Angl"),cTID("#Ang"),n),executeAction(cTID("Trnf"),e,DialogModes.NO)}return Stdlib.wrapLCLayer(e,t,r)},Stdlib.selectionFromVectorMask=function(e,t,n,r){function i(){var e=new ActionDescriptor,t=new ActionReference;t.putProperty(cTID("Chnl"),cTID("fsel")),e.putReference(cTID("null"),t);var i=new ActionReference;i.putEnumerated(cTID("Path"),cTID("Path"),sTID("vectorMask")),i.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("T   "),i),e.putBoolean(cTID("AntA"),n),e.putUnitDouble(cTID("Fthr"),cTID("#Pxl"),r),executeAction(cTID("setd"),e,DialogModes.NO)}return r||(r=0),n=!!n,Stdlib.wrapLCLayer(e,t,i)},Stdlib.appendVectorMaskToSelection=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putProperty(cTID("Chnl"),cTID("fsel")),e.putReference(cTID("null"),t);var n=new ActionReference;n.putEnumerated(cTID("Path"),cTID("Path"),sTID("vectorMask")),n.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("T   "),n),e.putBoolean(cTID("AntA"),!0),e.putUnitDouble(cTID("Fthr"),cTID("#Pxl"),0),executeAction(cTID("AddT"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,n)},Stdlib.getVectorMaskBounds=function(e,t){function n(){var n=e.activeHistoryState;Stdlib.selectionFromVectorMask(e,t);var r=Stdlib.getSelectionBounds(e);return e.activeHistoryState=n,r}var r=Stdlib.wrapLCLayer(e,t,n);return r},Stdlib.getVectorMaskBounds_cornerPointsOnly=function(e,t,n){function r(){var t=undefined,n=new ActionReference;n.putEnumerated(cTID("Path"),cTID("Path"),sTID("vectorMask")),n.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt"));var r=executeActionGet(n),i=r.getObjectValue(sTID("pathContents")),s=i.getList(sTID("pathComponents")),o=Infinity,u=-Infinity,a=Infinity,f=-Infinity,l=sTID("subpathListKey"),c=sTID("points"),h=sTID("anchor"),p=sTID("horizontal"),d=sTID("vertical");for(var v=0;v<s.count;++v){var m=s.getObjectValue(v).getList(l),g=m.getObjectValue(0).getList(c);for(var y=0;y<g.count;++y){var b=g.getObjectValue(y).getObjectValue(h),w=b.getUnitDoubleValue(p),E=b.getUnitDoubleValue(_id5);w<o&&(o=w),w>u&&(u=w),E<a&&(a=E),E>f&&(f=E)}}t=[o,a,u,f,u-o,f-a];if(e)for(var S=0;S<t.length;++S)t[S]=Math.round(t[S]);return t}e=!!e;var i=Stdlib.wrapLCLayer(t,n,r);return i},Stdlib.getVectorMaskAngle_cornerPointsOnly=function(e,t,n){function r(){var t=new ActionReference;t.putEnumerated(cTID("Path"),cTID("Path"),sTID("vectorMask")),t.putEnumerated(cTID("Lyr "),cTID("Ordn"),cTID("Trgt"));var n=executeActionGet(t),r=n.getObjectValue(sTID("pathContents")),i=r.getList(sTID("pathComponents")),s=sTID("anchor"),o=sTID("horizontal"),u=sTID("vertical"),a=0,f=i.getObjectValue(a).getList(sTID("subpathListKey")),l=f.getObjectValue(0).getList(sTID("points")),c=l.getObjectValue(0).getObjectValue(s),h=c.getUnitDoubleValue(o),p=c.getUnitDoubleValue(u),d=l.getObjectValue(1).getObjectValue(s),v=d.getUnitDoubleValue(o),m=d.getUnitDoubleValue(u),g=[v-h,m-p],y=Math.sqrt(g[0]*g[0]+g[1]*g[1]),b=Math.acos(g[1]/y),w=90-b*180/Math.PI;return h>v&&(w=-w),e||(w=Math.round(w*100)/100),w}return e=!!e,Stdlib.wrapLCLayer(t,n,r)},Stdlib.createSolidFillLayer=function(e,t){function n(){var e=new ActionDescriptor,n=new ActionReference;n.putClass(sTID("contentLayer")),e.putReference(cTID("null"),n);var r=new ActionDescriptor,i=new ActionDescriptor,s=new ActionDescriptor;s.putDouble(cTID("Rd  "),t.rgb.red),s.putDouble(cTID("Grn "),t.rgb.green),s.putDouble(cTID("Bl  "),t.rgb.blue),i.putObject(cTID("Clr "),cTID("RGBC"),s),r.putObject(cTID("Type"),sTID("solidColorLayer"),i),e.putObject(cTID("Usng"),sTID("contentLayer"),r),executeAction(cTID("Mk  "),e,DialogModes.NO)}return t||(t=Stdlib.createRGBColor(0,0,0)),Stdlib.wrapLC(e,n),e.activeLayer},Stdlib.createVectorMaskFromCurrentPath=function(e,t){function n(e){var t=new ActionDescriptor,n=new ActionReference;n.putClass(cTID("Path")),t.putReference(cTID("null"),n);var r=new ActionReference;r.putEnumerated(cTID("Path"),cTID("Path"),sTID("vectorMask")),t.putReference(cTID("At  "),r);var i=new ActionReference;i.putEnumerated(cTID("Path"),cTID("Ordn"),cTID("Trgt")),t.putReference(cTID("Usng"),i),executeAction(cTID("Mk  "),t,DialogModes.NO)}Stdlib.wrapLC(e,n)},Stdlib.saveVectorMaskAsPath=function(e,t,n){function r(){function e(e){return app.charIDToTypeID(e)}function t(e){return app.stringIDToTypeID(e)}var r=new ActionDescriptor,i=new ActionReference;i.putClass(e("Path")),r.putReference(e("null"),i);var s=new ActionReference;s.putEnumerated(e("Path"),e("Path"),t("vectorMask")),s.putEnumerated(e("Lyr "),e("Ordn"),e("Trgt")),r.putReference(e("From"),s),r.putString(e("Nm  "),n),executeAction(e("Mk  "),r,DialogModes.NO)}return Stdlib.wrapLCLayer(e,t,r),e.pathItems.getByName(n)},Stdlib.makeWorkPath=function(e,t){function n(e){var t=new ActionDescriptor,n=new ActionReference;n.putClass(cTID("Path")),t.putReference(cTID("null"),n);var r=new ActionReference;r.putProperty(cTID("csel"),cTID("fsel")),t.putReference(cTID("From"),r),t.putUnitDouble(cTID("Tlrn"),cTID("#Pxl"),Stdlib.makeWorkPath.tolerance),executeAction(cTID("Mk  "),t,DialogModes.NO)}Stdlib.makeWorkPath.tolerance=t!=undefined?t:2,Stdlib.wrapLC(e,n)},Stdlib.makePathActive=function(e,t){function n(){var e=new ActionDescriptor,n=new ActionReference;n.putName(cTID("Path"),t),e.putReference(cTID("null"),n),executeAction(cTID("slct"),e,DialogModes.NO)}Stdlib.wrapLC(e,n)},Stdlib.makeSelectionFromPath=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putProperty(cTID("Chnl"),cTID("fsel")),e.putReference(cTID("null"),t);var n=new ActionReference;n.putEnumerated(cTID("Path"),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("T   "),n),e.putBoolean(cTID("AntA"),!0),e.putUnitDouble(cTID("Fthr"),cTID("#Pxl"),0),executeAction(cTID("setd"),e,DialogModes.NO)}Stdlib.makePathActive(e,t),Stdlib.wrapLC(e,n)},Stdlib.getPathItems=function(e){function t(){var e=new ActionReference;e.putEnumerated(sTID("path"),sTID("ordinal"),sTID("targetEnum"));var t=executeActionGet(e),n=t.getObjectValue(sTID("pathContents"));return n.getList(sTID("pathComponents"))}return Stdlib.wrapLC(e,t)},Stdlib.deselectActivePath=function(e){function t(){var e=new ActionReference;e.putClass(cTID("Path"));var t=new ActionDescriptor;t.putReference(cTID("null"),e),executeAction(cTID("Dslc"),t,DialogModes.NO)}Stdlib.wrapLC(e,t)},Stdlib.decodePathMode=function(e){var t=null;switch(e){case ShapeOperation.SHAPEADD:t=cTID("AddT");break;case ShapeOperation.SHAPEINTERSECT:t=cTID();break;case ShapeOperation.SHAPESUBTRACT:t=cTID("SbtF");break;case ShapeOperation.SHAPEXOR:t=cTID();break;default:Error.runtimeError(1,"Shape mode not supported")}return t},Stdlib.decodePathUnit=function(e){var t=null;switch(e){case Units.PERCENT:t=cTID("#Prc");break;case Units.PIXELS:t=cTID("#Pxl");break;case Units.CM:case Units.INCHES:case Units.MM:case Units.PICAS:case Units.POINTS:default:Error.runtimeError(1,"Unit not supported")}return t},Stdlib.rectPath=function(e,t,n,r,i,s){var o=Stdlib.decodePathMode(e),u=Stdlib.decodePathUnit(t),a=new ActionDescriptor,f=new ActionReference;f.putEnumerated(cTID("Path"),cTID("Ordn"),cTID("Trgt"));var l=new ActionDescriptor;l.putUnitDouble(cTID("Top "),u,n),l.putUnitDouble(cTID("Left"),u,r),l.putUnitDouble(cTID("Btom"),u,i),l.putUnitDouble(cTID("Rght"),u,s),a.putReference(cTID("null"),f),a.putObject(cTID("T   "),cTID("Rctn"),l),executeAction(o,a,DialogModes.NO)},Stdlib.linePath=function(e,t,n,r,i,s,o){var u=Stdlib.decodePathMode(e),a=Stdlib.decodePathUnit(t),f=u,l=new ActionDescriptor,c=cTID("null"),h=new ActionReference,p=cTID("Path"),d=cTID("Ordn"),v=cTID("Trgt");h.putEnumerated(p,d,v),l.putReference(c,h);var m=cTID("T   "),g=new ActionDescriptor,y=cTID("Strt"),b=new ActionDescriptor,w=cTID("Hrzn"),E=a;b.putUnitDouble(w,E,r);var S=cTID("Vrtc"),E=a;b.putUnitDouble(S,E,i);var x=cTID("Pnt ");g.putObject(y,x,b);var T=cTID("End "),N=new ActionDescriptor,w=cTID("Hrzn"),E=a;N.putUnitDouble(w,E,s);var S=cTID("Vrtc"),E=a;N.putUnitDouble(S,E,o);var x=cTID("Pnt ");g.putObject(T,x,N);var C=cTID("Wdth"),E=a;g.putUnitDouble(C,E,n);var k=cTID("Ln  ");l.putObject(m,k,g),executeAction(f,l,DialogModes.NO)},Stdlib.flipPath=function(e,t){var n=cTID("Trnf"),r=new ActionDescriptor,i=new ActionReference;i.putEnumerated(cTID("Path"),cTID("Ordn"),cTID("Trgt")),r.putReference(cTID("null"),i),r.putEnumerated(cTID("FTcs"),cTID("QCSt"),cTID("Qcsa")),e&&r.putUnitDouble(cTID("Wdth"),cTID("#Prc"),-100),t&&r.putUnitDouble(cTID("Hght"),cTID("#Prc"),-100),executeAction(n,r,DialogModes.NO)},Stdlib.createPathPoint=function(e,t,n){var r=t||n?PointKind.SMOOTHPOINT:PointKind.CORNERPOINT;t||(t=e),n||(n=e);var i=new PathPointInfo;return i.anchor=e,i.leftDirection=t,i.rightDirection=n,i.kind=r,i},Stdlib.runAction=function(e,t){try{app.doAction(e,t)}catch(n){if(n.toString().match(/action.+is not currently available/))return!1;throw n}return!0},runAction=Stdlib.runAction,Stdlib.hasAction=function(e,t){var n,r=!1,i=1,s=[];for(;;){var o=new ActionReference;o.putIndex(cTID("ASet"),i);var u;try{u=executeActionGet(o)}catch(a){break}u.hasKey(cTID("Nm  "))&&u.getString(cTID("Nm  "))==t&&(n=u,s.push({index:i,desc:u})),i++}if(s.length==0)return!1;for(var i=0;i<s.length;i++){var f=s[i],l=f.index;n=f.desc;if(!n.hasKey(cTID("NmbC")))continue;var c=n.getInteger(cTID("NmbC"));for(var h=1;h<=c;h++){var o=new ActionReference;o.putIndex(cTID("Actn"),h),o.putIndex(cTID("ASet"),l);var u;try{u=executeActionGet(o)}catch(a){break}if(u.hasKey(cTID("Nm  "))&&u.getString(cTID("Nm  "))==e)return!0}}return r},Stdlib.deleteActionStep=function(e,t,n){function r(){var r=new ActionDescriptor,i=new ActionReference;i.putIndex(cTID("Cmnd"),e),i.putName(cTID("Actn"),t),i.putName(cTID("ASet"),n),r.putReference(cTID("null"),i),executeAction(cTID("Dlt "),r,DialogModes.NO)}r()},Stdlib.deleteAction=function(e,t){function n(){var n=new ActionDescriptor,r=new ActionReference;r.putName(cTID("Actn"),e),r.putName(cTID("ASet"),t),n.putReference(cTID("null"),r),executeAction(cTID("Dlt "),n,DialogModes.NO)}n()},Stdlib.deleteActionSet=function(e){function t(){var t=new ActionDescriptor,n=new ActionReference;n.putName(cTID("ASet"),e),t.putReference(cTID("null"),n),executeAction(cTID("Dlt "),t,DialogModes.NO)}try{t()}catch(n){if(!n.toString().match(/action that is playing or recording/))throw n;return!1}return!0},Stdlib.createDroplet=function(e,t,n){function r(){var r=new ActionDescriptor;r.putPath(cTID("In  "),n);var i=new ActionReference;i.putName(cTID("Actn"),e),i.putName(cTID("ASet"),t),r.putReference(cTID("Usng"),i),executeAction(cTID("CrtD"),r,DialogModes.NO)}n=Stdlib.convertFptr(n),r()},Stdlib.loadActionFile=function(e){Stdlib.btExec('app.load(new File("'+e.absoluteURI+'"));')},Stdlib.loadActionFiles=function(e){var t="";for(var n=0;n<e.length;n++){var r=e[0];t+='app.load(new File("'+r.absoluteURI+'"));\n'}Stdlib.btExec(t)},Stdlib.getActionSets=function(){var e=1,t=[];for(;;){var n=new ActionReference;n.putIndex(cTID("ASet"),e);var r,i=$.level;$.level=0;try{r=executeActionGet(n)}catch(s){break}finally{$.level=i}if(r.hasKey(cTID("Nm  "))){var o={};o.index=e,o.name=r.getString(cTID("Nm  ")),o.toString=function(){return this.name},o.count=r.getInteger(cTID("NmbC")),o.actions=[];for(var u=1;u<=o.count;u++){var n=new ActionReference;n.putIndex(cTID("Actn"),u),n.putIndex(cTID("ASet"),o.index);var a=executeActionGet(n),f=a.getString(cTID("Nm  "));o.actions.push(f)}t.push(o)}e++}return t},Stdlib.getActions=function(e){var t=1,n=[];if(!e)throw Error.runtimeError(9001,"Action set must be specified");for(;;){var r=new ActionReference;r.putIndex(cTID("ASet"),t);var i;try{i=executeActionGet(r)}catch(s){n=undefined;break}if(i.hasKey(cTID("Nm  "))){var o=i.getString(cTID("Nm  "));if(o==e){var u=i.getInteger(cTID("NmbC"));for(var a=1;a<=u;a++){var r=new ActionReference;r.putIndex(cTID("Actn"),a),r.putIndex(cTID("ASet"),t);var f=executeActionGet(r),l=f.getString(cTID("Nm  "));n.push(l)}break}}t++}return n},Stdlib.getSelectedAction=function(){var e={};try{var t=new ActionReference;t.putEnumerated(cTID("Actn"),cTID("Ordn"),cTID("Trgt"));var n=executeActionGet(t);e.name=n.getString(cTID("Nm  ")),e.set=n.getString(cTID("PrNm"))}catch(r){}return e},Stdlib.backupActionsPalette=function(e){e?e=Stdlib.convertFptr(e):e=File.saveDialog("Save Backup ActionsPalette","PSP Files:*.PSP,All files:*");if(e){app.preferencesFolder||Error.runtimeError(9001,"\rNo preferencesFolder property found. \rUnable to complete request.");var t=new File(app.preferencesFolder+"/Actions Palette.psp");t.exists||Error.runtimeError(9001,"Unable to locate palette file."),t.copy(e)||throwFileError(e,"Copy failed ")}},Stdlib.deleteAllActionSets=function(e){if(e!=0&&!confirm("Do you really want to empty your Actions Palette?"))return;var t=Stdlib.getActionSets();for(var n=t.length-1;n>=0;n--)Stdlib.deleteActionSet(t[n].name)},Stdlib.setActionPlaybackOption=function(e,t){function n(){var n=new ActionDescriptor,r=new ActionReference;r.putProperty(cTID("Prpr"),cTID("PbkO")),r.putEnumerated(cTID("capp"),cTID("Ordn"),cTID("Trgt")),n.putReference(cTID("null"),r);var i=new ActionDescriptor;i.putEnumerated(sTID("performance"),sTID("performance"),sTID(e)),e=="pause"&&t!=undefined&&i.putInteger(sTID("pause"),parseInt(t)),n.putObject(cTID("T   "),cTID("PbkO"),i),executeAction(cTID("setd"),n,DialogModes.NO)}n()},Stdlib.setPlaybackAccelerated=function(){Stdlib.setActionPlaybackOption("accelerated")},Stdlib.setPlaybackStepByStep=function(){Stdlib.setActionPlaybackOption("stepByStep")},Stdlib.setPlaybackPaused=function(e){Stdlib.setActionPlaybackOption("pause",e)},Stdlib.getApplicationDescriptor=function(){var e=new ActionReference;return e.putEnumerated(cTID("capp"),cTID("Ordn"),cTID("Trgt")),executeActionGet(e)},Stdlib.getDescriptorKeys=function(e){var t=[];for(var n=0;n<e.count;n++)t.push(e.getKey(n));return t},Stdlib.getDescriptorKeySyms=function(e){var t=[];for(var n=0;n<e.count;n++)t.push(id2char(e.getKey(n),"Key"));return t},Stdlib.getDescriptorKeyNames=function(e){var t=[];for(var n=0;n<e.count;n++)t.push(PSConstants.reverseNameLookup(e.getKey(n),"Key"));return t},Stdlib.fileImportDataSets=function(e){var t=new ActionDescriptor,n=new ActionReference;n.putClass(sTID("dataSetClass")),t.putReference(cTID("null"),n),t.putPath(cTID("Usng"),new File(e)),t.putEnumerated(cTID("Encd"),sTID("dataSetEncoding"),sTID("dataSetEncodingAuto")),t.putBoolean(sTID("eraseAll"),!0),t.putBoolean(sTID("useFirstColumn"),!1),executeAction(sTID("importDataSets"),t,DialogModes.NO)},Stdlib.applyDataSet=function(e){var t=new ActionDescriptor,n=new ActionReference;n.putName(sTID("dataSetClass"),e),t.putReference(cTID("null"),n),executeAction(cTID("Aply"),t,DialogModes.NO)},Stdlib.batch=function(e,t,n,r,i,s){(isCS()||isPS7())&&Error.runtimeError(9001,"Batch is only available in CS2+.");var o=new ActionDescriptor;if(e instanceof Array){for(var u=0;u<e.length;u++)Stdlib.batch(e[u],t,n,r,i,s),r.startingSerial++;return}var a;if(e instanceof Folder){if(i){var f;s==1?f=Stdlib.findFiles(e,i):f=Stdlib.getFiles(e,i),f.length>0&&Stdlib.batch(f,t,n,r,i,s);return}s==1&&(a=Stdlib.getFolders(e))}o.putPath(cTID("null"),e),r.suppressProfile==1&&o.putBoolean(sTID("suppressWarnings"),!0),r.suppressOpen==1&&o.putBoolean(sTID("suppressOpenOptions"),!0);var l=new ActionReference;l.putName(cTID("Actn"),t),l.putName(cTID("ASet"),n),o.putReference(cTID("Usng"),l),r.overrideOpen==1&&o.putBoolean(cTID("OvrO"),!0),r.destination!=BatchDestinationType.NODESTINATION&&o.putPath(cTID("T   "),r.destinationFolder);var c;r.destination==BatchDestinationType.FOLDER?c=r.fileNaming:r.destination==BatchDestinationType.SAVEANDCLOSE&&(c=[FileNamingType.DOCUMENTNAMEMIXED,FileNamingType.EXTENSIONLOWER]);if(c){c.length>6&&Error.runtimeError(9001,"Too many BatchOptions.fileNaming components.");var h=new ActionDescriptor,p=new ActionList;for(var u=0;u<r.fileNaming.length;u++){var d=r.fileNaming[u],v=new ActionDescriptor;if(typeof d=="string"||d instanceof String)v.putString(cTID("Txt "),r.fileNaming[u]);else{var m=Stdlib.batch.map[d];v.putEnumerated(sTID("component"),sTID("fileNamingComponent"),m)}p.putObject(sTID("fileNamingComponents"),v)}h.putList(sTID("fileNamingComponents"),p),h.putInteger(cTID("Strt"),r.startingSerial),h.putBoolean(cTID("Mcnt"),r.macintoshCompatible),h.putBoolean(cTID("Win "),r.windowsCompatible),h.putBoolean(sTID("unix"),r.unixCompatible),o.putObject(sTID("fileNamingRules"),sTID("fileNamingRules"),h)}r.destination!=BatchDestinationType.NODESTINATION&&r.overrideSave==1&&o.putBoolean(cTID("Ovrd"),!0),r.destination==BatchDestinationType.SAVEANDCLOSE&&o.putBoolean(cTID("SvAn"),!0),r.errorFile&&(o.putPath(cTID("Log "),r.errorFile.parent),o.putString(cTID("Nm  "),r.errorFile.name)),executeAction(cTID("Btch"),o,DialogModes.NO);if(a)for(var u=0;u<a.length;u++)Stdlib.batch(a[u],t,n,r,i,s)},Stdlib.batch.init=function(){if(!isPhotoshop())return;if(isCS()||isPS7())return;Stdlib.batch.map={},Stdlib.batch.map[FileNamingType.DDMM]=sTID("ddmm"),Stdlib.batch.map[FileNamingType.DDMMYY]=sTID("ddmmyy"),Stdlib.batch.map[FileNamingType.DOCUMENTNAMELOWER]=sTID("lowerCase"),Stdlib.batch.map[FileNamingType.DOCUMENTNAMEMIXED]=cTID("Nm  "),Stdlib.batch.map[FileNamingType.DOCUMENTNAMEUPPER]=sTID("upperCase"),Stdlib.batch.map[FileNamingType.EXTENSIONLOWER]=sTID("lowerCaseExtension"),Stdlib.batch.map[FileNamingType.EXTENSIONUPPER]=sTID("upperCaseExtension"),Stdlib.batch.map[FileNamingType.MMDD]=sTID("mmdd"),Stdlib.batch.map[FileNamingType.MMDDYY]=sTID("mmddyy"),Stdlib.batch.map[FileNamingType.SERIALLETTERLOWER]=sTID("upperCaseSerial"),Stdlib.batch.map[FileNamingType.SERIALLETTERUPPER]=sTID("lowerCaseSerial"),Stdlib.batch.map[FileNamingType.SERIALNUMBER1]=sTID("oneDigit"),Stdlib.batch.map[FileNamingType.SERIALNUMBER2]=sTID("twoDigit"),Stdlib.batch.map[FileNamingType.SERIALNUMBER3]=sTID("threeDigit"),Stdlib.batch.map[FileNamingType.SERIALNUMBER4]=sTID("fourDigit"),Stdlib.batch.map[FileNamingType.YYDDMM]=sTID("yyddmm"),Stdlib.batch.map[FileNamingType.YYMMDD]=sTID("yymmdd"),Stdlib.batch.map[FileNamingType.YYYYMMDD]=sTID("yyyymmdd")},Stdlib.batch.init(),Stdlib.selectColorRange=function(e,t,n,r){function s(){var e=new ActionDescriptor;e.putInteger(cTID("Fzns"),n);var t=new ActionDescriptor;t.putDouble(cTID("Lmnc"),i.l),t.putDouble(cTID("A   "),i.a),t.putDouble(cTID("B   "),i.b),e.putObject(cTID("Mnm "),cTID("LbCl"),t);var s=new ActionDescriptor;s.putDouble(cTID("Lmnc"),i.l),s.putDouble(cTID("A   "),i.a),s.putDouble(cTID("B   "),i.b),e.putObject(cTID("Mxm "),cTID("LbCl"),s),r&&e.putBoolean(cTID("Invr"),r),executeAction(cTID("ClrR"),e,DialogModes.NO)}var i=t instanceof SolidColor?t.lab:t;r==undefined&&(r=!1),n==undefined&&(n=40),Stdlib.wrapLC(e,s)},Stdlib.selectColorRangeRGB=function(e,t,n,r){if(t instanceof Array){var i=new RGBColor;i.red=t[0],i.green=t[1],i.blue=t[2],t=new SolidColor,t.rgb=i}else t instanceof RGBColor?(i=new SolidColor,i.rgb=t,t=i):Error.runtimeError(19,"color");Stdlib.selectColorRange(e,t,n,r)},Stdlib.selectOutOfGamutColor=function(e){function t(){var e=new ActionDescriptor;e.putEnumerated(cTID("Clrs"),cTID("Clrs"),cTID("OtOf")),executeAction(cTID("ClrR"),e,DialogModes.NO)}Stdlib.wrapLC(e,t)},Stdlib.rgbToString=function(e){return"["+e.rgb.red+","+e.rgb.green+","+e.rgb.blue+"]"},Stdlib.rgbToArray=function(e){return[e.rgb.red,e.rgb.green,e.rgb.blue]},Stdlib.rgbFromString=function(e){var t=/([\d\.]+),([\d\.]+),([\d\.]+)/,n=e.match(t);return n?Stdlib.createRGBColor(Number(n[1]),Number(n[2]),Number(n[3])):undefined},Stdlib.createRGBColor=function(e,t,n){var r=new RGBColor;e instanceof Array&&(n=e[2],t=e[1],e=e[0]),r.red=parseInt(e),r.green=parseInt(t),r.blue=parseInt(n);var i=new SolidColor;return i.rgb=r,i};try{isPhotoshop()&&(Stdlib.COLOR_BLACK=Stdlib.createRGBColor(0,0,0),Stdlib.COLOR_RED=Stdlib.createRGBColor(255,0,0),Stdlib.COLOR_GREEN=Stdlib.createRGBColor(0,255,0),Stdlib.COLOR_BLUE=Stdlib.createRGBColor(0,0,255),Stdlib.COLOR_GRAY=Stdlib.createRGBColor(128,128,128),Stdlib.COLOR_WHITE=Stdlib.createRGBColor(255,255,255))}catch(e){}Stdlib.colorFromString=function(e){var t=Stdlib.rgbFromString(e);return t||(e=e.toLowerCase(),e=="black"?t=Stdlib.COLOR_BLACK:e=="white"?t=Stdlib.COLOR_WHITE:e=="foreground"?t=app.foregroundColor:e=="background"?t=app.backgroundColor:e=="gray"||e=="grey"?t=Stdlib.COLOR_GRAY:e=="red"?t=Stdlib.COLOR_RED:e=="green"?t=Stdlib.COLOR_GREEN:e=="blue"&&(t=Stdlib.COLOR_BLUE)),t},Stdlib.setColorAt=function(e,t,n,r,i,s){Stdlib.selectBounds(e,[t,n,t+1,n+1],SelectionType.REPLACE,0,!1),Stdlib.hasSelection(e)||Error.runtimeError(20,"Unable to select pixel at "+t+","+n),i==undefined&&(i=ColorBlendMode.NORMAL),s==undefined&&(s=100),r?e.selection.fill(r,i,s):e.selection.clear()},Stdlib.putColorAt=Stdlib.setColorAt,Stdlib.getColorAt=function(e,t,n,r){if(!isCS()&&!isCS2()){t!=Math.ceil(t)&&(t+=.5),n!=Math.ceil(n)&&(n+=.5);var i=e.colorSamplers.add([UnitValue(t,"px"),UnitValue(n,"px")]),s=undefined;try{s=i.color}catch(o){}return i.remove(),s}if(!!r){r=!0;var u=e.activeHistoryState}t=Math.floor(t),n=Math.floor(n),Stdlib.selectBounds(e,[t,n,t+1,n+1]);try{function a(e){for(var t=0;t<=255;t++)if(e[t])return t;return 0}var f=new SolidColor;if(e.mode==DocumentMode.RGB)f.mode=ColorModel.RGB,f.rgb.red=a(e.channels.Red.histogram),f.rgb.green=a(e.channels.Green.histogram),f.rgb.blue=a(e.channels.Blue.histogram);else if(e.mode==DocumentMode.GRAYSCALE){var l=a(e.channels.Gray.histogram);f.mode=ColorModel.GRAYSCALE,f.gray.gray=100*(l/255)}else Error.runtimeError(9001,"Color Mode not supported: "+e.mode)}finally{r&&(e.activeHistoryState=u)}return f},Stdlib.convertProfile=function(e,t){function n(){var e=new ActionDescriptor,n=new ActionReference;n.putEnumerated(cTID("Dcmn"),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),n),e.putString(cTID("T   "),t),e.putEnumerated(cTID("Inte"),cTID("Inte"),cTID("Clrm")),e.putBoolean(cTID("MpBl"),!0),e.putBoolean(cTID("Dthr"),!1),e.putInteger(cTID("sdwM"),-1),executeAction(sTID("convertToProfile"),e,DialogModes.NO)}t=t.replace(/\.icc$/i,""),Stdlib.wrapLC(e,n)},Stdlib.convertMode=function(e,t){function r(){var e=new ActionDescriptor;e.putClass(cTID("T   "),cTID(n)),executeAction(sTID("convertMode"),e,DialogModes.NO)}var n;switch(t){case DocumentMode.BITMAP:n="BtmM";break;case DocumentMode.CMYK:n="CMYM";break;case DocumentMode.GRAYSCALE:n="Grys";break;case DocumentMode.INDEXEDCOLOR:n="IndC";break;case DocumentMode.LAB:n="LbCM";break;case DocumentMode.MULTICHANNEL:n="MltC";break;case DocumentMode.RGB:n="RGBM";break;default:Error.runtimeError(9001,"Bad color mode specified: "+t)}Stdlib.wrapLC(e,r)},Stdlib.colorModeString=function(e){var t="Unknown Mode",n=toNumber(e);if(isNaN(n))switch(e){case DocumentMode.BITMAP:t="Bitmap";break;case DocumentMode.CMYK:t="CMYK";break;case DocumentMode.DUOTONE:t="Duotone";break;case DocumentMode.GRAYSCALE:t="Grayscale";break;case DocumentMode.INDEXEDCOLOR:t="Indexed Color";break;case DocumentMode.LAB:t="Lab";break;case DocumentMode.MULTICHANNEL:t="Multichannel";break;case DocumentMode.RGB:t="RGB"}else switch(e){case 0:t="Bitmap";break;case 1:t="Grayscale";break;case 2:t="Indexed Color";break;case 3:t="RGB";break;case 4:t="CMYK";break;case 7:t="Multichannel";break;case 8:t="Duotone";break;case 9:t="Lab"}return t},Stdlib.copyrightedString=function(e){var t="";switch(e){case CopyrightedType.COPYRIGHTEDWORK:t="Copyrighted";break;case CopyrightedType.PUBLICDOMAIN:t="Public Domain";break;case CopyrightedType.UNMARKED:t="Unmarked"}return t},Stdlib.urgencyString=function(e){var t="";switch(e){case Urgency.LOW:t="Urgency Low";break;case Urgency.TWO:t="Urgency Two";break;case Urgency.THREE:t="Urgency Three";break;case Urgency.FOUR:t="Urgency Four";break;case Urgency.NORMAL:t="Urgency Normal";break;case Urgency.SIX:t="Urgency Six";break;case Urgency.SEVEN:t="Urgency Seven";break;case Urgency.HIGH:t="Urgency High"}return t},Stdlib.getFillLayerColor=function(e,t){var n=new SolidColor,r=Stdlib.getLayerDescriptor(e,t),i=r.getList(cTID("Adjs")),s=i.getObjectValue(0),o=s.getObjectValue(cTID("Clr "));return n.rgb.red=o.getDouble(cTID("Rd  ")),n.rgb.green=o.getDouble(cTID("Grn ")),n.rgb.blue=o.getDouble(cTID("Bl  ")),n},Stdlib.setFillLayerColor=function(e,t,n){function r(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(sTID("contentLayer"),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("null"),t);var r=new ActionDescriptor,i=new ActionDescriptor;return i.putDouble(cTID("Rd  "),n.rgb.red),i.putDouble(cTID("Grn "),n.rgb.green),i.putDouble(cTID("Bl  "),n.rgb.blue),r.putObject(cTID("Clr "),cTID("RGBC"),i),e.putObject(cTID("T   "),sTID("solidColorLayer"),r),executeAction(cTID("setd"),e,DialogModes.NO)}return Stdlib.wrapLCLayer(e,t,r)},Stdlib.createSwatch=function(e,t,n,r){var i=new ActionDescriptor;i.putDouble(cTID("Rd  "),t),i.putDouble(cTID("Grn "),n),i.putDouble(cTID("Bl  "),r);var s=new ActionDescriptor;s.putString(cTID("Nm  "),e),s.putObject(cTID("Clr "),cTID("RGBC"),i);var o=new ActionReference;o.putClass(cTID("Clrs"));var u=new ActionDescriptor;u.putReference(cTID("null"),o),u.putObject(cTID("Usng"),cTID("Clrs"),s),app.executeAction(cTID("Mk  "),u,DialogModes.NO)},Stdlib.saveAllPatterns=function(e){var t=new ActionDescriptor;t.putPath(cTID("null"),e);var n=new ActionReference;n.putProperty(cTID("Prpr"),cTID("Ptrn")),n.putEnumerated(cTID("capp"),cTID("Ordn"),cTID("Trgt")),t.putReference(cTID("T   "),n),executeAction(cTID("setd"),t,DialogModes.NO)},Stdlib.savePatterns=function(e,t){var n=new ActionDescriptor;n.putPath(cTID("null"),e);var r=new ActionList;for(var i=0;i<t.length;i++){var s=new ActionReference;s.putIndex(cTID("Ptrn"),t[i]),r.putReference(s)}n.putList(cTID("T   "),r),executeAction(cTID("setd"),n,DialogModes.NO)},Stdlib.savePattern=function(e,t){Stdlib.savePatterns(e,[t])},Stdlib.fillPattern=function(e,t,n){function r(){var e=new ActionDescriptor;e.putEnumerated(cTID("Usng"),cTID("FlCn"),cTID("Ptrn"));var r=new ActionDescriptor;t&&r.putString(cTID("Nm  "),t),n&&r.putString(cTID("Idnt"),n),e.putObject(cTID("Ptrn"),cTID("Ptrn"),r),e.putUnitDouble(cTID("Opct"),cTID("#Prc"),100),e.putEnumerated(cTID("Md  "),cTID("BlnM"),cTID("Nrml")),executeAction(cTID("Fl  "),e,DialogModes.NO)}Stdlib.wrapLC(e,r)},Stdlib.definePatternFromSelection=function(e,t){function n(){var e=new ActionDescriptor,n=new ActionReference;n.putClass(cTID("Ptrn")),e.putReference(cTID("null"),n);var r=new ActionReference;r.putProperty(cTID("Prpr"),cTID("fsel")),r.putEnumerated(cTID("Dcmn"),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("Usng"),r),e.putString(cTID("Nm  "),t),executeAction(cTID("Mk  "),e,DialogModes.NO)}Stdlib.wrapLC(e,n)},Stdlib.createGuide=function(e,t,n){function r(){var e=new ActionDescriptor,r=new ActionDescriptor;r.putUnitDouble(cTID("Pstn"),cTID("#Pxl"),n),r.putEnumerated(cTID("Ornt"),cTID("Ornt"),cTID(t)),e.putObject(cTID("Nw  "),cTID("Gd  "),r),executeAction(cTID("Mk  "),e,DialogModes.NO)}Stdlib.wrapLC(e,r)},Stdlib.createVerticalGuide=function(e,t){Stdlib.createGuide(e,"Vrtc",t)},Stdlib.createHorizontalGuide=function(e,t){Stdlib.createGuide(e,"Hrzn",t)},Stdlib.clearGuides=function(e){function t(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Gd  "),cTID("Ordn"),cTID("Al  ")),e.putReference(cTID("null"),t),executeAction(cTID("Dlt "),e,DialogModes.NO)}Stdlib.wrapLC(e,t)},Stdlib.renameChannel=function(e,t,n){var r=e.activeChannels;for(var i=0;i<r.length;i++){var s=r[i];if(s.name==t){s.name=n;return}}},Stdlib.selectChannel=function(e,t,n){function r(){var e=new ActionDescriptor,t=new ActionReference;t.putEnumerated(cTID("Chnl"),cTID("Chnl"),cTID(n)),e.putReference(cTID("null"),t),e.putBoolean(cTID("MkVs"),!1),executeAction(cTID("slct"),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,r)},Stdlib.selectRGBChannel=function(e,t){Stdlib.selectChannel(e,t,"RGB ")},Stdlib.drawLine=function(e,t,n){var r=new PathPointInfo;r.anchor=t,r.leftDirection=t,r.rightDirection=t,r.kind=PointKind.CORNERPOINT;var i=new PathPointInfo;i.anchor=n,i.leftDirection=n,i.rightDirection=n,i.kind=PointKind.CORNERPOINT;var s=new SubPathInfo;s.closed=!1,s.operation=ShapeOperation.SHAPEXOR,s.entireSubPath=[r,i];var o=e.pathItems.add("Line",[s]);o.strokePath(ToolType.PENCIL),o.remove()},Stdlib.selectEllipse=function(e,t,n){n=n!=0;var r=new ActionDescriptor,i=new ActionReference;i.putProperty(cTID("Chnl"),cTID("fsel")),r.putReference(cTID("null"),i);var s=new ActionDescriptor;s.putUnitDouble(cTID("Top "),cTID("#Pxl"),t[1]),s.putUnitDouble(cTID("Left"),cTID("#Pxl"),t[0]),s.putUnitDouble(cTID("Btom"),cTID("#Pxl"),t[3]),s.putUnitDouble(cTID("Rght"),cTID("#Pxl"),t[2]),r.putObject(cTID("T   "),cTID("Elps"),s),r.putBoolean(cTID("AntA"),!0),executeAction(cTID("setd"),r,DialogModes.NO)},Stdlib.stop=function(e,t){e==undefined&&(e="Operation cancelled.");var n=new ActionDescriptor;n.putString(cTID("Msge"),e),t!=undefined&&n.putBoolean(cTID("Cntn"),t),app.executeAction(cTID("Stop"),n,DialogModes.ALL)},Stdlib.addTextLayer=function(e,t,n,r){var i=e.artLayers.add();i.kind=LayerKind.TEXT,n&&(i.name=n),i.blendMode=BlendMode.NORMAL,i.opacity=100;var s=i.textItem,o=app.preferences.rulerUnits,u=app.preferences.typeUnits;try{var a=Stdlib.createRGBColor(255,255,255);app.preferences.typeUnits=TypeUnits.POINTS,app.preferences.rulerUnits=Units.PIXELS,s.size=r?r:24,s.font="ArialMT",s.kind=TextType.PARAGRAPHTEXT,s.color=a,app.preferences.rulerUnits=Units.PERCENT,s.position=new Array(5,5),app.preferences.rulerUnits=Units.PIXELS,s.width=e.width,s.height=e.height,s.contents=t}finally{app.preferences.rulerUnits=o,app.preferences.typeUnits=u}return i},Stdlib.addInfoTextLayer=Stdlib.addTextLayer,Stdlib.convertTextLayerToShape=function(e,t){function n(){var e=new ActionDescriptor,t=new ActionReference;t.putClass(sTID("contentLayer")),e.putReference(cTID("null"),t);var n=new ActionReference;n.putEnumerated(cTID("TxLr"),cTID("Ordn"),cTID("Trgt")),e.putReference(cTID("Usng"),n),executeAction(cTID("Mk  "),e,DialogModes.NO)}Stdlib.wrapLCLayer(e,t,n)},Stdlib.getPSFontList=function(){var e=app.fonts,t=[e.length];for(var n=0;n<e.length;n++)t[n]=e[n].postScriptName;return t},Stdlib.findPSFont=function(e){var t=Stdlib.getByName(app.fonts,e);return t?t.postScriptName:undefined},Stdlib.getFont=function(e){var t=app.fonts;for(var n=0;n<t.length;n++)if(e==t[n].postScriptName)return t[n];return undefined},Stdlib.findFont=function(e){var t=app.fonts;for(var n=0;n<t.length;n++)if(e==t[n].name)return t[n];return undefined},Stdlib.determineFont=function(e){return Stdlib.getByName(app.fonts,e)||Stdlib.getByProperty(app.fonts,"postScriptName",e)},Stdlib.getDefaultFont=function(){var e;isMac()?e=localize("$$$/Project/Effects/Icon/Font/Name/Mac=Lucida Grande"):e=localize("$$$/Project/Effects/Icon/Font/Name/Win=Tahoma");var t=Stdlib.determineFont(e);if(!t){var n=Stdlib.getApplicationProperty(sTID("fontLargeName"));n!=undefined&&(t=Stdlib.determineFont(n))}return t},Stdlib.getDefaultTypeToolFont=function(){var e=undefined,t="typeCreateOrEditTool";try{var n=new ActionReference;n.putEnumerated(cTID("capp"),cTID("Ordn"),cTID("Trgt"));var r=executeActionGet(n),i=r.getEnumerationType(sTID("tool")),s=typeIDToStringID(i);if(s!=t){var r=new ActionDescriptor,n=new ActionReference;n.putClass(sTID(t)),r.putReference(cTID("null"),n),executeAction(cTID("slct"),r,DialogModes.NO)}var n=new ActionReference;n.putEnumerated(cTID("capp"),cTID("Ordn"),cTID("Trgt"));var r=executeActionGet(n),o=r.hasKey(cTID("CrnT"))?r.getObjectValue(cTID("CrnT")):undefined;if(o){var u=new ActionDescriptor,a=new ActionReference;a.putClass(sTID("toolPreset")),u.putReference(cTID("null"),a);var f=new ActionReference;f.putProperty(cTID("Prpr"),cTID("CrnT")),f.putEnumerated(cTID("capp"),cTID("Ordn"),cTID("Trgt")),u.putReference(cTID("Usng"),f),u.putString(cTID("Nm  "),"__temp__"),executeAction(cTID("Mk  "),u,DialogModes.NO);var l=new ActionDescriptor,c=new ActionReference;c.putProperty(cTID("Prpr"),cTID("CrnT")),c.putEnumerated(cTID("capp"),cTID("Ordn"),cTID("Trgt")),l.putReference(cTID("null"),c),executeAction(cTID("Rset"),l,DialogModes.NO);var n=new ActionReference;n.putEnumerated(cTID("capp"),cTID("Ordn"),cTID("Trgt"));var r=executeActionGet(n),o=r.getObjectValue(cTID("CrnT")),h=o.getObjectValue(sTID("textToolCharacterOptions")),p=h.getObjectValue(cTID("TxtS"));e=p.getString(sTID("fontPostScriptName"));var d=new ActionDescriptor,v=new ActionReference;v.putName(sTID("toolPreset"),"__temp__"),d.putReference(cTID("null"),v),executeAction(cTID("slct"),d,DialogModes.NO);var m=new ActionDescriptor,g=new ActionReference;g.putEnumerated(sTID("toolPreset"),cTID("Ordn"),cTID("Trgt")),m.putReference(cTID("null"),g),executeAction(cTID("Dlt "),m,DialogModes.NO)}if(s!=t){var r=new ActionDescriptor,n=new ActionReference;n.putClass(i),r.putReference(cTID("null"),n),executeAction(cTID("slct"),r,DialogModes.NO)}}catch(y){return undefined}return e},Stdlib.setFontRealName=function(e){var t=new ActionReference;t.putProperty(sTID("property"),sTID("textStyle")),t.putEnumerated(sTID("textLayer"),sTID("ordinal"),sTID("targetEnum"));var n=new ActionDescriptor;n.putReference(sTID("null"),t);var r=new ActionDescriptor;r.putString(sTID("fontName"),e),r.putObject(sTID("to"),sTID("textStyle"),n),executeAction(sTID("set"),r,DialogModes.NO)},Stdlib.unitValueRex=/(-)?(\d+)?(\.\d+)? (in|ft|yd|mi|mm|cm|m|km|pt|pc|tpt|ptc|ci|px|%)/,Stdlib.fullStop=function(e){if(e!=0){$.level=1;debugger}},Stdlib.pause=function(units){for(var i=0;i<units;i++){var x=11.40093,y=33.902312;Stdlib.pause_dummy=eval("Math.sqrt(x/y)")}},Stdlib.listGlobals=function(){var e=[];for(var t in global)e.push(t);e.sort();var n="";for(var r in e){t=e[r],n+=t+":  ";try{var i=global[t];n+="["+typeof i+"]",typeof i!="function"&&(n+=":  "+global[t].toString())}catch(s){n+="[]"}n+="\r\n"}return n},listGlobals=Stdlib.listGlobals,Stdlib.listProps=function(e){var t="",n=isBridge()?"\r":"\r\n";for(var r in e){t+=r+":  ";try{var i=e[r];t+=typeof i=="function"?"[function]":i}catch(s){}t+=n}return t},listProps=Stdlib.listProps,Stdlib.dumpGlobals=function(e){var t=new File(e||"/c/temp/globals.log");t.open("w","TEXT","????"),t.writeln(listGlobals()),t.close()},Stdlib.showtext=function(t){confirm(t)},Stdlib.waitForRedraw=function(){var e=new ActionDescriptor;e.putEnumerated(cTID("Stte"),cTID("Stte"),cTID("RdCm")),executeAction(cTID("Wait"),e,DialogModes.NO)},Stdlib._dumpRI=function(e){var t="",n=["name","arguments","dataType","defaultValue","description","help","isCollection","max","min","type"];t+=" "+e.name+"\r\n";for(var r=0;r<n.length;r++){var i=n[r],s=e[i];s!=undefined&&(t+="   "+i+" : "+s+"\r\n")}return t},Stdlib.dumpRTI=function(e){var t=e.reflect,n="";n+="//\r\n// "+t.name+"\r\n//    "+t.help+"\r\n//\r\n",n+="class "+t.name+"\r\n",n+="  props:\r\n";for(var r=0;r<t.properties.length;r++){var i=t.properties[r];n+=Stdlib._dumpRI(i)}n+="  methods:\r\n";for(var r=0;r<t.methods.length;r++){var i=t.methods[r];n+=Stdlib._dumpRI(i)}return n},Stdlib.getLastJSLogEntry=function(e){e?e=Stdlib.convertFptr(e):(e=new File("/c/ScriptingListenerJS.log"),e.exists||Error.runtimeError(Stdlib.IO_ERROR_CODE,"Unable to find SLC log.")),e.open("r","TEXT","????")||throwFileError(e,"Unable to open"),e.seek(1,2);var t=e.readch();for(var n=2;n<e.length;n++){e.seek(n,2);var r=e.readch();if(r=="\n"&&t=="/")break;t=r}if(n==e.length&&t!="/")return undefined;e.readln();if(!isCS()&&!isCS2()&&!isCS3()){var i=e.tell(),s=e.read();s[0]=="a"&&(e.seek(i-1),s=e.read())}else var s=e.read();return e.close(),s},Stdlib.writeDescriptor=function(e,t){e=Stdlib.convertFptr(e),e.encoding="BINARY",e.open("w")||throwFileError(e);var n=t.toStream();e.write(n)||throwFileError(e),e.close(),delete n},Stdlib.readDescriptor=function(e){var e=Stdlib.convertFptr(e);e.encoding="BINARY",e.open("r")||throwFileError(e);var t=e.read();e.close();var n=new ActionDescriptor;return n.fromStream(t),n},Stdlib._units=undefined,Stdlib._unitsInit=function(){if(!isPhotoshop())return;Stdlib._units=app.preferences.rulerUnits.toString(),Stdlib._unitMap={},Stdlib._unitMap[Units.INCHES.toString()]="in",Stdlib._unitMap[Units.CM.toString()]="cm",Stdlib._unitMap[Units.MM.toString()]="mm",Stdlib._unitMap[Units.PERCENT.toString()]="%",Stdlib._unitMap[Units.PICAS.toString()]="pc",Stdlib._unitMap[Units.PIXELS.toString()]="px",Stdlib._unitMap[Units.POINTS.toString()]="pt",Stdlib._unitStrMap={},Stdlib._unitStrMap["in"]="in",Stdlib._unitStrMap.cm="cm",Stdlib._unitStrMap.mm="mm",Stdlib._unitStrMap["%"]="%",Stdlib._unitStrMap.pc="picas",Stdlib._unitStrMap.px="pixels",Stdlib._unitStrMap.pt="points"},Stdlib._unitsInit(),Stdlib.getDefaultUnits=function(){return Stdlib._unitMap[Stdlib._units]},Stdlib.getDefaultUnitsString=function(){return Stdlib._unitStrMap[Stdlib._unitMap[Stdlib._units]]},Stdlib.getDefaultRulerUnitsString=Stdlib.getDefaultUnitsString,Stdlib.validateUnitValue=function(e,t,n){var r=this;if(e instanceof UnitValue)return e;if(t&&t.typename=="Document"){var i=t;n=i.width.type,t=UnitValue(1/i.resolution,n)}else n||(n=Stdlib.getDefaultRulerUnitsString()),t||(UnitValue.baseUnit=UnitValue(1/72,n));e=e.toString();var s=new UnitValue("0 "+n),o=s;return e.match(/[a-z%]+/)||(e+=" "+n.units),o=new UnitValue(e),isNaN(o.value)||o.type=="?"?undefined:(o.value==0&&(o=s),o)},Stdlib.getPixelValue=function(e,t,n,r){var i;if(t==undefined)return Number.NaN;t.constructor==Number&&(t=t.toString());if(t.constructor!=String)return Number.NaN;e.constructor==Number?i=e:i=e.resolution,t=t.trim(),r||(r=Stdlib.getDefaultUnits());var s=new UnitValue(t);if(s.type=="?"){var o=parseFloat(t);if(isNaN(o))return Number.NaN;s=new UnitValue(o,r)}s.type=="%"&&(s=new UnitValue(n*s.value/100,"px"));var u;return s.type=="in"?u=i*s.value:s.type=="px"?u=s.value:(s.baseUnit=new UnitValue(1/i,"in"),u=s.as("px")),u},FileBrowser=function(){},FileBrowser.getSelectedFiles=function(){return FileBrowser.getFiles(!0,!1)},FileBrowser.getFlaggedFiles=function(){return FileBrowser.getFiles(!1,!0)},FileBrowser.getFiles=function(e,t){var n=new Array,r=0,i=new ActionReference,s=sTID("fileBrowser");i.putProperty(cTID("Prpr"),s),i.putEnumerated(cTID("capp"),cTID("Ordn"),cTID("Trgt"));var o=executeActionGet(i);if(o.count>0&&o.hasKey(s)){var u=o.getObjectValue(s),a=cTID("flst");if(u.count>0&&u.hasKey(a)){var f=u.getList(a),l=sTID("flagged"),c=cTID("fsel"),h=cTID("Path");for(var p=0;p<f.count;p++){var d=f.getObjectValue(p);if(d.count>0&&d.hasKey(h)){if(t==1&&d.hasKey(l)&&d.getBoolean(l)){var v=d.getPath(h);v instanceof File&&(n[r++]=v)}if(t==1&&d.hasKey(l)&&d.getBoolean(l)){var v=d.getPath(h);v instanceof File&&(n[r++]=v)}else if(e==1&&d.hasKey(c)&&d.getBoolean(c)){var v=d.getPath(h);v instanceof File&&(n[r++]=v)}if(e!=1&&t!=1){var v=d.getPath(h);v instanceof File&&(n[r++]=v)}}}}}return n},Set=function(){},Set.add=function(e,t){return Set.merge(e,new Array(t))},Set.remove=function(e,t){var n=Set.copy(e);for(var r in n)n[r]==t&&n.splice(r,1);return n},Set.contains=function(e,t){for(var n in e)if(e[n]==t)return!0;return!1},Set.merge=function(e,t){var n=new Object,r=[];if(e!=undefined)for(var i in e)typeof e[i]!="function"&&(n[e[i]]=1);if(t!=undefined)for(var i in t)typeof t[i]!="function"&&(n[t[i]]=1);for(var i in n)typeof n[i]!="function"&&r.push(i);return r.sort(),r},Set.copy=function(e){return e.slice(0)},ColorProfileNames={},ColorProfileNames.ADOBE_RGB="Adobe RGB (1998)",ColorProfileNames.APPLE_RGB="Apple RGB",ColorProfileNames.PROPHOTO_RGB="ProPhoto RGB",ColorProfileNames.SRGB="sRGB IEC61966-2.1",ColorProfileNames.COLORMATCH_RGB="ColorMatch RGB",ColorProfileNames.WIDEGAMUT_RGB="Wide Gamut RGB",Stdlib.getProfileNameFromFile=function(e){e.encoding="BINARY",e.open("r");var t=e.read();e.close();var n=t.match(/\x00desc\x00/);if(n==null)return e.name.replace(/\.ic(c|m)/i,"");var r=n.index+12,i=t.charCodeAt(r),s=t.substring(r+1,r+i);return s},Timer=function(){var e=this;e.startTime=0,e.stopTime=0,e.elapsed=0,e.cummulative=0,e.count=0},Timer.prototype.start=function(){this.startTime=(new Date).getTime()},Timer.prototype.stop=function(){var e=this;e.stopTime=(new Date).getTime(),e.elapsed=(e.stopTime-e.startTime)/1e3,e.cummulative+=e.elapsed,e.count++,e.per=e.cummulative/e.count},String.prototype.sprintf=function(){var e=[this];for(var t=0;t<arguments.length;t++)e.push(arguments[t]);return String.sprintf.apply(null,e)},String.sprintf=function(){function e(){if(!arguments||arguments.length<1||!RegExp)return"Error";var e=arguments[0],t=/([^%]*)%('.|0|\x20)?(-)?(\d+)?(\.\d+)?(%|b|c|d|u|f|o|s|x|X)/m,n=b=[],r=0,i=0,s="";while(n=t.exec(e)){var o=n[1],u=n[2],a=n[3],f=n[4],l=n[5],c=n[6],h=n[7];h=e.slice(n[0].length),i++;if(c=="%")y="%";else{r++,r>=arguments.length&&alert("Error! Not enough function arguments ("+(arguments.length-1)+", excluding the string)\n"+"for the number of substitution parameters in string ("+r+" so far).");var p=arguments[r],d="";u&&u.slice(0,1)=="'"?d=o.slice(1,2):u&&(d=u);var v=!0;a&&a==="-"&&(v=!1);var m=-1;f&&(m=toNumber(f));var g=-1;l&&c=="f"&&(g=toNumber(l.substring(1)));var y=p;switch(c){case"b":y=toNumber(p).toString(2);break;case"c":y=String.fromCharCode(toNumber(p));break;case"d":y=toNumber(p)?Math.round(toNumber(p)):0;break;case"u":y=Math.abs(Math.round(toNumber(p)));break;case"f":g==-1&&(g=6),y=parseFloat(p).toFixed(Math.min(g,20)),y=y.replace(".",$.decimalPoint);break;case"o":y=toNumber(p).toString(8);break;case"s":y=p;break;case"x":y=(""+toNumber(p).toString(16)).toLowerCase();break;case"X":y=(""+toNumber(p).toString(16)).toUpperCase()}var w=m-y.toString().length;if(w>0)var E=new Array(w+1),S=E.join(d?d:" ");else var S=""}s+=o+S+y,e=h}return s+=e,s}return e.apply(null,arguments)},Date.prototype.strftime=function(e){return Date.strftime(this,e)},Date.strftime=function(e,t){var n=e,r=Date.prototype.strftime._cnvt,i=t,s,o=/([^%]*)%([%aAbBcCdDehHIjmMprRStTuwxXyYZ]{1})(.*)/,u="";while(s=o.exec(i)){var a=s[1],f=s[2],l=s[3];u+=a+r[f](n),i=l}return u+=i,u},Date.strftime.iso8601_date="%Y-%m-%d",Date.strftime.iso8601_full="%Y-%m-%dT%H:%M:%S",Date.strftime.iso8601="%Y-%m-%d %H:%M:%S",Date.strftime.iso8601_time="%H:%M:%S",Date.prototype.toISO=function(){return this.strftime(Date.strftime.iso8601)},Date.prototype.strftime._cnvt={zeropad:function(e){return e>9?e:"0"+e},spacepad:function(e){return e>9?e:" "+e},ytd:function(e){var t=(new Date(e.getFullYear(),0,1)).getTime(),n=e.getTime()-t;return parseInt(n/1e3/60/60/24)+1},a:function(e){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()]},A:function(e){return["Sunday","Monday","Tuesdsay","Wednesday","Thursday","Friday","Saturday"][e.getDay()]},b:function(e){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()]},B:function(e){return["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()]},c:function(e){return this.a(e)+" "+this.b(e)+" "+this.e(e)+" "+this.H(e)+":"+this.M(e)+":"+this.S(e)+" "+this.Y(e)},C:function(e){return this.Y(e).slice(0,2)},d:function(e){return this.zeropad(e.getDate())},D:function(e){return this.m(e)+"/"+this.d(e)+"/"+this.y(e)},e:function(e){return this.spacepad(e.getDate())},F:function(e){return this.Y(e)+"-"+this.m(e)+"-"+this.d(e)},g:function(e){return"-"},G:function(e){return"-"},h:function(e){return this.b(e)},H:function(e){return this.zeropad(e.getHours())},I:function(e){var t=this.zeropad((e.getHours()+12)%12);return t=="00"?"12":t},j:function(e){return this.ytd(e)},k:function(e){return this.spacepad(e.getHours())},l:function(e){var t=this.spacepad((e.getHours()+12)%12);return t==" 0"?"12":t},m:function(e){return this.zeropad(e.getMonth()+1)},M:function(e){return this.zeropad(e.getMinutes())},n:function(e){return"\n"},p:function(e){return this.H(e)<12?"AM":"PM"},r:function(e){return this.I(e)+":"+this.M(e)+":"+this.S(e)+" "+this.p(e)},R:function(e){return this.H(e)+":"+this.M(e)},S:function(e){return this.zeropad(e.getSeconds())},t:function(e){return" "},T:function(e){return this.H(e)+":"+this.M(e)+":"+this.S(e)+" "+this.p(e)},u:function(e){return e.getDay()?e.getDay()+1:7},U:function(e){return"-"},w:function(e){return e.getDay()},W:function(e){return"-"},x:function(e){return this.D(e)},X:function(e){return this.T(e)},y:function(e){return this.zeropad(this.Y(e)%100)},Y:function(e){return e.getFullYear().toString()},z:function(e){return""},Z:function(e){return""},"%":function(e){return"%"}},File.prototype.toUIString=function(){return decodeURI(this.fsName)},Folder.prototype.toUIString=function(){return decodeURI(this.fsName)},File.prototype.asString=File.prototype.toUIString,File.prototype.strf=function(e,t){var n=this,r=decodeURI(n.name),i=r.match(/.+\.([^\.\/]+)$/),s=i?i[1]:"";i=r.match(/(.+)\.[^\.\/]+$/);var o=i?i[1]:r;t|=!$.os.match(/windows/i);var u=decodeURI(t?n.parent.fsName:n.parent.absoluteURI),a=decodeURI(n.parent.name),f=e,l=/([^%]*)%(-)?(\d+)?(\.\d+)?(%|d|e|f|p)(.*)/,c="";while(i=l.exec(f)){var h=i[1],p=i[2],d=i[3],v=i[4],m=i[5],g=i[6],y="";if(m=="%")y="%";else{var b="";switch(m){case"d":b=u;break;case"e":b=s;break;case"f":b=o;break;case"p":b=a}var w=b.length;if(w&&(d||v)){v=v?Number(v.slice(1)):0;if(d){d=Number(d);if(p){var E=w-d-v;y=b.slice(E,E+d)}else y=b.slice(v,v+d)}else p?y=b.slice(0,w-v):y=b.slice(v)}else y=b}c+=h+y,f=g}return c+=f,c},Folder.prototype.strf=File.prototype.strf,Stdlib.DEFAULT_GPS_FORMAT="%d deg %d' %.2f\"",Stdlib.strfGPSstr=function(e,t){var n=t.match(/(\d+\.\d+) (\d+\.\d+)\' (\d+\.\d+)\"/);if(!n)var r=n=t.match(/(\d+)\,(\d+)(\,|\.)(\d+)/);if(!n)var i=/(\d+(?:\.\d+)?)[^\d\.]+(\d+(?:\.\d+)?)[^\d\.]+(\d+(?:\.\d+)?)/,s=n=t.match(i);if(!n)return e;if(!r){var o=Number(n[1]),u=Number(n[2]),a=Number(n[3]),f=(o-Math.floor(o))*60,l=(u-Math.floor(u))*60;return u+=a/60,o+=u/60,a==0&&(a=l),u==0&&(u=f),Stdlib.strfGPS(e,o,u,a)}if(r){var o=Number(n[1]),c=n[3];if(c==".")var u=Number(n[2]),a=Number("0."+n[4])*60;else var u=Number(n[2]),a=Number(n[4]);return Stdlib.strfGPS(e,o,u,a)}return e},Stdlib.strfGPS=function(e,t,n,r){return r==undefined&&(r=0),n==undefined&&(n=0),n==Math.floor(n)&&(n+=r/60),t==Math.floor(t)&&(t+=n/60),e==undefined&&(e=Stdlib.DEFAULT_GPS_FORMAT),String.sprintf(e,t,n,r)},Stdlib.getXMPValue=function(obj,tag){var xmp;obj.constructor==String?xmp=new XML(obj):obj.typename=="Document"?xmp=new XML(obj.xmpMetadata.rawData):obj instanceof XML?xmp=obj:Error.runtimeError(19,"obj");var s;return tag=="ISOSpeedRatings"?s=String(eval("xmp.*::RDF.*::Description.*::ISOSpeedRatings.*::Seq.*::li")):s=String(eval("xmp.*::RDF.*::Description.*::"+tag)),s},Stdlib.loadXMPScript=function(){ExternalObject.AdobeXMPScript||(ExternalObject.AdobeXMPScript=new ExternalObject("lib:AdobeXMPScript"))},Stdlib.unloadXMPScript=function(){ExternalObject.AdobeXMPScript&&(ExternalObject.AdobeXMPScript.unload(),ExternalObject.AdobeXMPScript=undefined)},Stdlib.toDescriptor=function(e){function i(e,i,s){var o=typeof s,u=new ActionDescriptor;u.putString(t,i);switch(o){case"number":u.putDouble(n,s);break;case"string":u.putString(n,s);break;case"boolean":u.putBoolean(n,s);break;case"object":u.putString(n,s.toString());break;case"undefined":u=undefined;break;case"function":u=undefined;break;default:u=undefined}e.putObject(sTID(i),r,u)}arguments.length!=1&&Error.runtimeError(1221,"obj"),e==undefined&&Error.runtimeError(2,"obj"),typeof e!="object"&&Error.runtimeError(21,"obj");var t=cTID("nm  "),n=cTID("Vl  "),r=sTID("component"),s=new ActionDescriptor;for(var o in e){if(o.startsWith("_"))continue;var u=e[o];if(u||typeof u=="undefined"||typeof u=="function")continue;i(s,o,u)}return s},Stdlib.fromDescriptor=function(e,t){function i(e){var t=e.getType(r),n=undefined;switch(t){case DescValueType.DOUBLETYPE:n=e.getDouble(r);break;case DescValueType.INTEGERTYPE:n=e.getInteger(r);break;case DescValueType.STRINGTYPE:n=e.getString(r);break;case DescValueType.BOOLEANTYPE:n=e.getBoolean(r)}return n}(arguments.length<1||arguments.length>2)&&Error.runtimeError(1221),e==undefined&&Error.runtimeError(2,"desc"),typeof e!="object"&&Error.runtimeError(21,"desc"),e instanceof ActionDescriptor||Error.runtimeError(1330);var n=cTID("nm  "),r=cTID("Vl  ");t||(t={});for(var s=0;s<e.count;s++){var o=e.getKey(s),u=e.getObjectValue(o),a=u.getString(n),f=i(u);f!=undefined&&(t[a]=f)}return t},Stdlib.objectToXML=function(obj,name,xml){function _addChild(xml,obj,idx){var val=obj[idx],isArray=obj instanceof Array;if(idx.toString()[0]=="_")return undefined;if(val==undefined)return undefined;var type=typeof val,child;isNumber(idx)&&(idx=xml.localName()+idx);switch(type){case"number":case"boolean":case"string":child=new XML("<"+idx+"></"+idx+">"),child.appendChild(val),eval("child.@type = type");break;case"object":child=Stdlib.objectToXML(val,idx);break;default:return undefined}xml.appendChild(child)}xml||(name==undefined&&(name="Object"),xml=new XML("<"+name+"></"+name+">"),eval('xml.@type = (obj instanceof Array) ? "array" : "object"'));if(obj instanceof Array)for(var i=0;i<obj.length;i++)_addChild(xml,obj,i);else{for(var idx in obj)_addChild(xml,obj,idx);xml.children().length()==0&&(xml.appendChild(obj.toString()),eval('xml.@type = "string"'))}return xml},Stdlib.xmlToObject=function(xml,obj,parent){xml.constructor==String?xml=new XML(xml):xml instanceof XML?xml=xml.copy():Error.runtimeError(2,"xml"),xml.normalize();if(xml.hasSimpleContent()){var str=xml.toString();return parent&&(parent[xml.localName()]=str),str}var type;eval("type = xml.@type.toString()"),type=="array"?obj=[]:obj={};var els=xml.elements(),len=els.length();if(len>0)for(var i=0;i<len;i++){var child=els[i],val="",idx=type=="array"?i:child.localName();child.hasComplexContent()&&(val=Stdlib.xmlToObject(child));if(child.hasSimpleContent()){var ctype;eval("ctype = child.@type.toString()"),val=child.text().toString(),val&&(ctype=="number"&&(val=Number(val)),ctype=="boolean"&&(val=val.toLowerCase()=="true"))}obj[idx]=val}else obj=xml.toString();return parent&&(parent[xml.localName()]=obj),obj},Stdlib.openURL=function(e){var t="shortcut.url",n=new File(Folder.temp+"/"+t);n.open("w"),n.writeln("[InternetShortcut]"),n.writeln("URL="+e),n.writeln(),n.close(),n.execute(),n.remove()}